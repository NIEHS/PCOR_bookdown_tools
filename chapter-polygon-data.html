<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Polygon Data | CHORDS Training and Use Cases Toolkit</title>
  <meta name="description" content="The CHORDS Training and Use Cases Toolkit provides guides, tutorials, and example code to support environmental health and disaster research." />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Polygon Data | CHORDS Training and Use Cases Toolkit" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="The CHORDS Training and Use Cases Toolkit provides guides, tutorials, and example code to support environmental health and disaster research." />
  <meta name="github-repo" content="NIEHS/PCOR_bookdown_tools" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Polygon Data | CHORDS Training and Use Cases Toolkit" />
  
  <meta name="twitter:description" content="The CHORDS Training and Use Cases Toolkit provides guides, tutorials, and example code to support environmental health and disaster research." />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter-point-data.html"/>
<link rel="next" href="chapter-raster-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">CHORDS Training and Use Cases Toolkit</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><strong>Introduction</strong></a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-chords"><i class="fa fa-check"></i>About CHORDS</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-this-toolkit"><i class="fa fa-check"></i>About This Toolkit</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="unit-geospatial-foundations.html"><a href="unit-geospatial-foundations.html"><i class="fa fa-check"></i><strong>Geospatial Data Foundations</strong></a></li>
<li class="chapter" data-level="1" data-path="chapter-getting-started-spatial.html"><a href="chapter-getting-started-spatial.html"><i class="fa fa-check"></i><b>1</b> Getting Started</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chapter-getting-started-spatial.html"><a href="chapter-getting-started-spatial.html#introduction-1"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="chapter-getting-started-spatial.html"><a href="chapter-getting-started-spatial.html#concepts-and-terminology"><i class="fa fa-check"></i><b>1.2</b> Concepts and Terminology</a></li>
<li class="chapter" data-level="1.3" data-path="chapter-getting-started-spatial.html"><a href="chapter-getting-started-spatial.html#datasets"><i class="fa fa-check"></i><b>1.3</b> Datasets</a></li>
<li class="chapter" data-level="1.4" data-path="chapter-getting-started-spatial.html"><a href="chapter-getting-started-spatial.html#r-packages"><i class="fa fa-check"></i><b>1.4</b> <code>R</code> Packages</a></li>
<li class="chapter" data-level="1.5" data-path="chapter-getting-started-spatial.html"><a href="chapter-getting-started-spatial.html#chapter-getting-started-spatial-resources"><i class="fa fa-check"></i><b>1.5</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter-point-data.html"><a href="chapter-point-data.html"><i class="fa fa-check"></i><b>2</b> Point Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter-point-data.html"><a href="chapter-point-data.html#introduction-2"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="chapter-point-data.html"><a href="chapter-point-data.html#access-download-and-unzip"><i class="fa fa-check"></i><b>2.2</b> Access, Download, and Unzip</a></li>
<li class="chapter" data-level="2.3" data-path="chapter-point-data.html"><a href="chapter-point-data.html#data-preparation"><i class="fa fa-check"></i><b>2.3</b> Data Preparation</a></li>
<li class="chapter" data-level="2.4" data-path="chapter-point-data.html"><a href="chapter-point-data.html#exploratory-analysis"><i class="fa fa-check"></i><b>2.4</b> Exploratory Analysis</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter-polygon-data.html"><a href="chapter-polygon-data.html"><i class="fa fa-check"></i><b>3</b> Polygon Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter-polygon-data.html"><a href="chapter-polygon-data.html#introduction-3"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="chapter-polygon-data.html"><a href="chapter-polygon-data.html#chapter-polygon-access"><i class="fa fa-check"></i><b>3.2</b> Access, Download, and Unzip</a></li>
<li class="chapter" data-level="3.3" data-path="chapter-polygon-data.html"><a href="chapter-polygon-data.html#data-preparation-with-sf"><i class="fa fa-check"></i><b>3.3</b> Data Preparation with <code>sf</code></a></li>
<li class="chapter" data-level="3.4" data-path="chapter-polygon-data.html"><a href="chapter-polygon-data.html#exploratory-analysis-with-sf"><i class="fa fa-check"></i><b>3.4</b> Exploratory Analysis with <code>sf</code></a></li>
<li class="chapter" data-level="3.5" data-path="chapter-polygon-data.html"><a href="chapter-polygon-data.html#data-preparation-with-terra"><i class="fa fa-check"></i><b>3.5</b> Data Preparation with <code>terra</code></a></li>
<li class="chapter" data-level="3.6" data-path="chapter-polygon-data.html"><a href="chapter-polygon-data.html#exploratory-analysis-with-terra"><i class="fa fa-check"></i><b>3.6</b> Exploratory Analysis with <code>terra</code></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter-raster-data.html"><a href="chapter-raster-data.html"><i class="fa fa-check"></i><b>4</b> Raster Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter-raster-data.html"><a href="chapter-raster-data.html#introduction-4"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="chapter-raster-data.html"><a href="chapter-raster-data.html#raster-access"><i class="fa fa-check"></i><b>4.2</b> Access and Download</a></li>
<li class="chapter" data-level="4.3" data-path="chapter-raster-data.html"><a href="chapter-raster-data.html#data-preparation-1"><i class="fa fa-check"></i><b>4.3</b> Data Preparation</a></li>
<li class="chapter" data-level="4.4" data-path="chapter-raster-data.html"><a href="chapter-raster-data.html#exploratory-analysis-1"><i class="fa fa-check"></i><b>4.4</b> Exploratory Analysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="wildfire-data.html"><a href="wildfire-data.html"><i class="fa fa-check"></i><strong>Wildfire Data</strong></a></li>
<li class="chapter" data-level="" data-path="other-environmental-data.html"><a href="other-environmental-data.html"><i class="fa fa-check"></i><strong>Other Environmental Data</strong></a></li>
<li class="chapter" data-level="5" data-path="chapter-nasa-earthdata.html"><a href="chapter-nasa-earthdata.html"><i class="fa fa-check"></i><b>5</b> NASA EarthData Download</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter-nasa-earthdata.html"><a href="chapter-nasa-earthdata.html#introduction-5"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="chapter-nasa-earthdata.html"><a href="chapter-nasa-earthdata.html#nasa-earthdata-account"><i class="fa fa-check"></i><b>5.2</b> NASA EarthData Account</a></li>
<li class="chapter" data-level="5.3" data-path="chapter-nasa-earthdata.html"><a href="chapter-nasa-earthdata.html#generate-prerequisite-files"><i class="fa fa-check"></i><b>5.3</b> Generate Prerequisite Files</a></li>
<li class="chapter" data-level="5.4" data-path="chapter-nasa-earthdata.html"><a href="chapter-nasa-earthdata.html#download-data"><i class="fa fa-check"></i><b>5.4</b> Download Data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="health-data-integration.html"><a href="health-data-integration.html"><i class="fa fa-check"></i><strong>Health Data Integration</strong></a></li>
<li class="chapter" data-level="6" data-path="chapter-link-to-census.html"><a href="chapter-link-to-census.html"><i class="fa fa-check"></i><b>6</b> Linkage to Census Units</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter-link-to-census.html"><a href="chapter-link-to-census.html#introduction-6"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="chapter-link-to-census.html"><a href="chapter-link-to-census.html#tutorial"><i class="fa fa-check"></i><b>6.2</b> Tutorial</a></li>
<li class="chapter" data-level="6.3" data-path="chapter-link-to-census.html"><a href="chapter-link-to-census.html#concluding-remarks"><i class="fa fa-check"></i><b>6.3</b> Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter-fhir-pit.html"><a href="chapter-fhir-pit.html"><i class="fa fa-check"></i><b>7</b> A FHIR PIT Tutorial</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chapter-fhir-pit.html"><a href="chapter-fhir-pit.html#introduction-7"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="chapter-fhir-pit.html"><a href="chapter-fhir-pit.html#tutorial-1"><i class="fa fa-check"></i><b>7.2</b> Tutorial</a></li>
<li class="chapter" data-level="7.3" data-path="chapter-fhir-pit.html"><a href="chapter-fhir-pit.html#fhir-pit-considerations"><i class="fa fa-check"></i><b>7.3</b> Considerations</a></li>
<li class="chapter" data-level="7.4" data-path="chapter-fhir-pit.html"><a href="chapter-fhir-pit.html#concluding-remarks-1"><i class="fa fa-check"></i><b>7.4</b> Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="use-cases.html"><a href="use-cases.html"><i class="fa fa-check"></i><strong>Use Cases</strong></a></li>
<li class="chapter" data-level="8" data-path="chapter-hcup-amadeus-usecase.html"><a href="chapter-hcup-amadeus-usecase.html"><i class="fa fa-check"></i><b>8</b> HCUP and Amadeus Smoke Plume Use Case</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chapter-hcup-amadeus-usecase.html"><a href="chapter-hcup-amadeus-usecase.html#motivation-4"><i class="fa fa-check"></i><b>8.1</b> Motivation</a></li>
<li class="chapter" data-level="8.2" data-path="chapter-hcup-amadeus-usecase.html"><a href="chapter-hcup-amadeus-usecase.html#tutorial-2"><i class="fa fa-check"></i><b>8.2</b> Tutorial</a></li>
<li class="chapter" data-level="8.3" data-path="chapter-hcup-amadeus-usecase.html"><a href="chapter-hcup-amadeus-usecase.html#link-to-hcupAmadeus-1"><i class="fa fa-check"></i><b>8.3</b> Data Curation and Prep</a></li>
<li class="chapter" data-level="8.4" data-path="chapter-hcup-amadeus-usecase.html"><a href="chapter-hcup-amadeus-usecase.html#link-to-hcupAmadeus-2"><i class="fa fa-check"></i><b>8.4</b> Downloading and Processing Exposure Data with the <code>amadeus</code> Package</a></li>
<li class="chapter" data-level="8.5" data-path="chapter-hcup-amadeus-usecase.html"><a href="chapter-hcup-amadeus-usecase.html#data-analysis-using-hcup-and-amadeus-data-sources"><i class="fa fa-check"></i><b>8.5</b> Data Analysis using HCUP and Amadeus data sources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><strong>Appendix</strong></a></li>
<li class="chapter" data-level="" data-path="chapter-user-profiles.html"><a href="chapter-user-profiles.html"><i class="fa fa-check"></i><strong>A</strong> User Profiles</a></li>
<li class="chapter" data-level="" data-path="chords-glossary.html"><a href="chords-glossary.html"><i class="fa fa-check"></i><strong>B</strong> Glossary</a></li>
<li class="chapter" data-level="" data-path="all-references-appendix.html"><a href="all-references-appendix.html"><i class="fa fa-check"></i><strong>C</strong> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" 
target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">CHORDS Training and Use Cases Toolkit</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter-polygon-data" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Polygon Data<a href="chapter-polygon-data.html#chapter-polygon-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><a href="chapter-user-profiles.html#profilecmp"><img src="images/user_profiles/profilecmp.svg" alt="Profile-CMP" /></a>
<a href="chapter-user-profiles.html#profilesbs"><img src="images/user_profiles/profilesbs.svg" alt="Profile-SBS" /></a>
<a href="chapter-user-profiles.html#profilestu"><img src="images/user_profiles/profilestu.svg" alt="Profile-STU" /></a></p>
<div id="polygon-data-access-preparation-and-exploratory-analysis-in-r" class="section level3 unnumbered hasAnchor">
<h3>Polygon Data Access, Preparation, and Exploratory Analysis in R<a href="chapter-polygon-data.html#polygon-data-access-preparation-and-exploratory-analysis-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Date Modified:</strong> August 16, 2024</p>
<p><strong>Authors:</strong> Mitchell Manware <a href="https://orcid.org/0009-0003-6440-6106"><img src="images/orcid.png" width="10" alt="author-mm" /></a>, Kyle P. Messier <a href="https://orcid.org/0000-0001-9508-9623"><img src="images/orcid.png" width="10" alt="author-kpm" /></a></p>
<p><strong>Key Terms:</strong> <a href="chords-glossary.html#def-geospatial-data">Geospatial Data</a>, <a href="https://tools.niehs.nih.gov/cchhglossary/?keyword=wildfire&amp;termOnlySearch=true&amp;exactSearch=true">Wildfire</a></p>
<p><strong>Programming Language:</strong> R</p>
</div>
<div id="introduction-3" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Introduction<a href="chapter-polygon-data.html#introduction-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Wildfire smoke plume coverage data from the United States National Oceanic and Atmospheric Administration (NOAA) will be used to demonstrate using polygon data. This tutorial will cover polygon data with both the <code>sf</code> <span class="citation">(<a href="#ref-r-sf-1">1</a>)</span> and <code>terra</code> <span class="citation">(<a href="#ref-r-terra">9</a>)</span> packages separately, but the steps for accessing, downloading, and unzipping the data is the same for both packages.</p>
<p>This tutorial will demonstrate the following steps with polygon data in <code>R</code>:</p>
<ul>
<li>Downloading data from a URL</li>
<li>Importing data</li>
<li>Checking data type, structure, and class</li>
<li>Reclassifying data</li>
<li>Computing summary and zonal statistics</li>
<li>Plotting individual and multiple data sets</li>
</ul>
<div class="important">
<p>The exploratory analyses in this unit are designed for educational purposes only. The results of the following analyses are not peer-reviewed findings, nor are they based on any hypotheses.</p>
</div>
</div>
<div id="chapter-polygon-access" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Access, Download, and Unzip<a href="chapter-polygon-data.html#chapter-polygon-access" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The website URL where the NOAA wildfire smoke plume data exists is date-specific, meaning there is a unique URL for each daily data set. For the purpose of these exploratory analyses, wildfire smoke plume data from September 1, 2023 will be used.</p>
<p>Define three variables for <code>day</code>, <code>month</code>, and <code>year</code> according to the date of interest.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="chapter-polygon-data.html#cb77-1" tabindex="-1"></a>day <span class="ot">&lt;-</span> <span class="st">&quot;01&quot;</span></span>
<span id="cb77-2"><a href="chapter-polygon-data.html#cb77-2" tabindex="-1"></a>month <span class="ot">&lt;-</span> <span class="st">&quot;09&quot;</span></span>
<span id="cb77-3"><a href="chapter-polygon-data.html#cb77-3" tabindex="-1"></a>year <span class="ot">&lt;-</span> <span class="st">&quot;2023&quot;</span></span></code></pre></div>
<p>The <code>utils::download.file()</code> function downloads the file according to the defined URL and destination file.</p>
<div class="note">
<p>Multiple chunks of code in this tutorial will contain <code>./dataset/</code>, a fixed directory path to run the tutorial code. To run the code on your machine, substitute <code>./dataset/</code> with the file path where you would like to store the tutorial data.</p>
</div>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="chapter-polygon-data.html#cb78-1" tabindex="-1"></a>url_noaa <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb78-2"><a href="chapter-polygon-data.html#cb78-2" tabindex="-1"></a>  <span class="st">&quot;https://satepsanone.nesdis.noaa.gov/pub/FIRE/web/HMS/Smoke_Polygons&quot;</span>,</span>
<span id="cb78-3"><a href="chapter-polygon-data.html#cb78-3" tabindex="-1"></a>  <span class="st">&quot;/Shapefile/&quot;</span>,</span>
<span id="cb78-4"><a href="chapter-polygon-data.html#cb78-4" tabindex="-1"></a>  year,</span>
<span id="cb78-5"><a href="chapter-polygon-data.html#cb78-5" tabindex="-1"></a>  <span class="st">&quot;/&quot;</span>,</span>
<span id="cb78-6"><a href="chapter-polygon-data.html#cb78-6" tabindex="-1"></a>  month,</span>
<span id="cb78-7"><a href="chapter-polygon-data.html#cb78-7" tabindex="-1"></a>  <span class="st">&quot;/hms_smoke&quot;</span>,</span>
<span id="cb78-8"><a href="chapter-polygon-data.html#cb78-8" tabindex="-1"></a>  year,</span>
<span id="cb78-9"><a href="chapter-polygon-data.html#cb78-9" tabindex="-1"></a>  month,</span>
<span id="cb78-10"><a href="chapter-polygon-data.html#cb78-10" tabindex="-1"></a>  day,</span>
<span id="cb78-11"><a href="chapter-polygon-data.html#cb78-11" tabindex="-1"></a>  <span class="st">&quot;.zip&quot;</span></span>
<span id="cb78-12"><a href="chapter-polygon-data.html#cb78-12" tabindex="-1"></a>)</span>
<span id="cb78-13"><a href="chapter-polygon-data.html#cb78-13" tabindex="-1"></a></span>
<span id="cb78-14"><a href="chapter-polygon-data.html#cb78-14" tabindex="-1"></a>destination_noaa <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb78-15"><a href="chapter-polygon-data.html#cb78-15" tabindex="-1"></a>  <span class="st">&quot;./dataset/noaa/noaa_smoke&quot;</span>,</span>
<span id="cb78-16"><a href="chapter-polygon-data.html#cb78-16" tabindex="-1"></a>  year,</span>
<span id="cb78-17"><a href="chapter-polygon-data.html#cb78-17" tabindex="-1"></a>  month,</span>
<span id="cb78-18"><a href="chapter-polygon-data.html#cb78-18" tabindex="-1"></a>  day,</span>
<span id="cb78-19"><a href="chapter-polygon-data.html#cb78-19" tabindex="-1"></a>  <span class="st">&quot;.zip&quot;</span></span>
<span id="cb78-20"><a href="chapter-polygon-data.html#cb78-20" tabindex="-1"></a>)</span>
<span id="cb78-21"><a href="chapter-polygon-data.html#cb78-21" tabindex="-1"></a></span>
<span id="cb78-22"><a href="chapter-polygon-data.html#cb78-22" tabindex="-1"></a><span class="fu">download.file</span>(</span>
<span id="cb78-23"><a href="chapter-polygon-data.html#cb78-23" tabindex="-1"></a>  url_noaa,</span>
<span id="cb78-24"><a href="chapter-polygon-data.html#cb78-24" tabindex="-1"></a>  destination_noaa</span>
<span id="cb78-25"><a href="chapter-polygon-data.html#cb78-25" tabindex="-1"></a>)</span></code></pre></div>
<p>The file downloaded from the NOAA website is a <code>.zip</code> file. Zip files need to be unzipped (decompressed) in order to access the data within. Unzip the NOAA wildfire smoke plume coverage file with <code>utils::unzip()</code>.</p>
<div class="warning">
<p>Unzipping a <code>.zip</code> file will decompress the contents within. Spatial data sets can be very large (i.e., &gt; 1 GB), so check the size of the data before unzipping on your machine.</p>
</div>
<p>The numeric value size of each file is listed under <code>Length</code>.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="chapter-polygon-data.html#cb79-1" tabindex="-1"></a><span class="fu">unzip</span>(</span>
<span id="cb79-2"><a href="chapter-polygon-data.html#cb79-2" tabindex="-1"></a>  <span class="st">&quot;./dataset/noaa/noaa_smoke20230901.zip&quot;</span>,</span>
<span id="cb79-3"><a href="chapter-polygon-data.html#cb79-3" tabindex="-1"></a>  <span class="at">list =</span> <span class="cn">TRUE</span></span>
<span id="cb79-4"><a href="chapter-polygon-data.html#cb79-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>##                    Name Length                Date
## 1 hms_smoke20230901.shp  29796 2023-09-02 11:19:00
## 2 hms_smoke20230901.shx    564 2023-09-02 11:19:00
## 3 hms_smoke20230901.dbf   3177 2023-09-02 11:19:00
## 4 hms_smoke20230901.prj    145 2023-09-02 11:19:00</code></pre>
<p>After inspecting the file sizes, unzip <code>noaa_smoke20230901.zip</code>.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="chapter-polygon-data.html#cb81-1" tabindex="-1"></a><span class="fu">unzip</span>(</span>
<span id="cb81-2"><a href="chapter-polygon-data.html#cb81-2" tabindex="-1"></a>  <span class="st">&quot;./dataset/noaa/noaa_smoke20230901.zip&quot;</span>,</span>
<span id="cb81-3"><a href="chapter-polygon-data.html#cb81-3" tabindex="-1"></a>  <span class="at">exdir =</span> <span class="st">&quot;./dataset/noaa/&quot;</span></span>
<span id="cb81-4"><a href="chapter-polygon-data.html#cb81-4" tabindex="-1"></a>)</span></code></pre></div>
<p>Inspecting the file with <code>utils::unzip(list = TRUE)</code> returned the size of the file, but also the name of the data file of interest. The desired data file can also be identified with <code>list.files()</code>.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="chapter-polygon-data.html#cb82-1" tabindex="-1"></a><span class="fu">list.files</span>(<span class="st">&quot;./dataset/noaa/&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;hms_smoke20230901.dbf&quot;  &quot;hms_smoke20230901.prj&quot;  &quot;hms_smoke20230901.shp&quot; 
## [4] &quot;hms_smoke20230901.shx&quot;  &quot;noaa_smoke20230901.zip&quot;</code></pre>
<p>Listing the contents of the unzipped file reveals four individual files. The data to be imported is stored in the <code>hms_smoke20230901.shp</code>, but the other files contain important information for the <code>.shp</code> file.</p>
<div class="warning">
<p>Deleting any of the supporting files (i.e., <code>*.dbf</code>, <code>*.prj</code>, or <code>*.shx</code>) will disrupt the data import.</p>
</div>
</div>
<div id="data-preparation-with-sf" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Data Preparation with <code>sf</code><a href="chapter-polygon-data.html#data-preparation-with-sf" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section will focus on exploratory analyses with polygon data using the <code>sf</code> package.</p>
<div id="import-1" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Import<a href="chapter-polygon-data.html#import-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that the contents of the zip file have been saved on your machine and the data file of interest has been identified, import the data with <code>sf::st_read()</code>.</p>
<div class="note">
<p>Although the supporting files are required to import a shapefile, only the file ending in <code>.shp</code> needs to be imported</p>
</div>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="chapter-polygon-data.html#cb84-1" tabindex="-1"></a>smoke_sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_read</span>(<span class="st">&quot;./dataset/noaa/hms_smoke20230901.shp&quot;</span>)</span></code></pre></div>
<pre><code>## Reading layer `hms_smoke20230901&#39; from data source 
##   `/home/runner/work/PCOR_bookdown_tools/PCOR_bookdown_tools/dataset/noaa/hms_smoke20230901.shp&#39; 
##   using driver `ESRI Shapefile&#39;
## Simple feature collection with 58 features and 4 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: -149.8003 ymin: 13.58187 xmax: -13.8847 ymax: 75.17942
## Geodetic CRS:  WGS 84</code></pre>
<p>Importing <code>hms_smoke20230901.shp</code> does not return a <code>Warning:</code> message because the data set has native spatial features, and is therefore imported as an <code>sf</code> object.</p>
</div>
<div id="inspect-structure-1" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Inspect Structure<a href="chapter-polygon-data.html#inspect-structure-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Inspect the structure of <code>smoke_sf</code> to see its class, column names, column classes, and the first two (specified by <code>vec.len = 2</code>) data points.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="chapter-polygon-data.html#cb86-1" tabindex="-1"></a><span class="fu">str</span>(</span>
<span id="cb86-2"><a href="chapter-polygon-data.html#cb86-2" tabindex="-1"></a>  smoke_sf,</span>
<span id="cb86-3"><a href="chapter-polygon-data.html#cb86-3" tabindex="-1"></a>  <span class="at">vec.len =</span> <span class="dv">2</span></span>
<span id="cb86-4"><a href="chapter-polygon-data.html#cb86-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Classes &#39;sf&#39; and &#39;data.frame&#39;:   58 obs. of  5 variables:
##  $ Satellite: chr  &quot;GOES-EAST&quot; &quot;GOES-EAST&quot; ...
##  $ Start    : chr  &quot;2023244 0900&quot; &quot;2023244 1300&quot; ...
##  $ End      : chr  &quot;2023244 1300&quot; &quot;2023244 1700&quot; ...
##  $ Density  : chr  &quot;Light&quot; &quot;Light&quot; ...
##  $ geometry :sfc_POLYGON of length 58; first list element: List of 1
##   ..$ : num [1:211, 1:2] -51.4 -48.8 ...
##   ..- attr(*, &quot;class&quot;)= chr [1:3] &quot;XY&quot; &quot;POLYGON&quot; ...
##  - attr(*, &quot;sf_column&quot;)= chr &quot;geometry&quot;
##  - attr(*, &quot;agr&quot;)= Factor w/ 3 levels &quot;constant&quot;,&quot;aggregate&quot;,..: NA NA NA NA
##   ..- attr(*, &quot;names&quot;)= chr [1:4] &quot;Satellite&quot; &quot;Start&quot; ...</code></pre>
<p>As mentioned previously, the <code>smoke_sf</code> data set has native spatial features. These are reflected by the data set having classes of <code>sf</code> and <code>data.frame</code>, and the <code>$geometry</code> feature.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="chapter-polygon-data.html#cb88-1" tabindex="-1"></a><span class="fu">class</span>(smoke_sf)</span></code></pre></div>
<pre><code>## [1] &quot;sf&quot;         &quot;data.frame&quot;</code></pre>
</div>
<div id="chapter-polygon-sf-reclassify" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Reclassify<a href="chapter-polygon-data.html#chapter-polygon-sf-reclassify" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The main parameter of interest in this data set is <code>$Density</code>, which discretely categorizes each wildfire smoke plume as “Light”, “Medium”, or “Heavy”. Checking its class shows that <code>$Density</code> is class character.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="chapter-polygon-data.html#cb90-1" tabindex="-1"></a><span class="fu">class</span>(smoke_sf<span class="sc">$</span>Density)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p>Nominal data, data without fixed order or rank system, can be stored as class character (i.e., State names). However, it is best to store ordinal data as class factor for conducting analyses in R.</p>
<p>Converting data from class character to class factor can be done with <code>factor()</code>. The <code>levels = c()</code> argument in the function specifies both the level names and the ranked order of the levels.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="chapter-polygon-data.html#cb92-1" tabindex="-1"></a>smoke_sf<span class="sc">$</span>Density <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb92-2"><a href="chapter-polygon-data.html#cb92-2" tabindex="-1"></a>  smoke_sf<span class="sc">$</span>Density,</span>
<span id="cb92-3"><a href="chapter-polygon-data.html#cb92-3" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Light&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Heavy&quot;</span>)</span>
<span id="cb92-4"><a href="chapter-polygon-data.html#cb92-4" tabindex="-1"></a>)</span></code></pre></div>
<p>Check the class of <code>$Density</code> again to ensure proper reclassification.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="chapter-polygon-data.html#cb93-1" tabindex="-1"></a><span class="fu">class</span>(smoke_sf<span class="sc">$</span>Density)</span></code></pre></div>
<pre><code>## [1] &quot;factor&quot;</code></pre>
</div>
<div id="coordinate-reference-system-and-projection-1" class="section level3 hasAnchor" number="3.3.4">
<h3><span class="header-section-number">3.3.4</span> Coordinate Reference System and Projection<a href="chapter-polygon-data.html#coordinate-reference-system-and-projection-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Check the coordinate reference system of an <code>sf</code> object with <code>sf::st_crs()</code>.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="chapter-polygon-data.html#cb95-1" tabindex="-1"></a>sf<span class="sc">::</span><span class="fu">st_crs</span>(smoke_sf)</span></code></pre></div>
<pre><code>## Coordinate Reference System:
##   User input: WGS 84 
##   wkt:
## GEOGCRS[&quot;WGS 84&quot;,
##     DATUM[&quot;World Geodetic System 1984&quot;,
##         ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
##             LENGTHUNIT[&quot;metre&quot;,1]]],
##     PRIMEM[&quot;Greenwich&quot;,0,
##         ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
##     CS[ellipsoidal,2],
##         AXIS[&quot;latitude&quot;,north,
##             ORDER[1],
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
##         AXIS[&quot;longitude&quot;,east,
##             ORDER[2],
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
##     ID[&quot;EPSG&quot;,4326]]</code></pre>
<p><code>smoke_sf</code> has a native coordinate reference system which was imported during the <code>sf::st_read()</code> step. The area of interest for these exploratory analyses is the conterminous United States, so we can transform <code>smoke_sf</code> to the Albers Equal Area projected coordinate system (EPSG code: 5070).</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="chapter-polygon-data.html#cb97-1" tabindex="-1"></a>smoke_sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_transform</span>(</span>
<span id="cb97-2"><a href="chapter-polygon-data.html#cb97-2" tabindex="-1"></a>  smoke_sf,</span>
<span id="cb97-3"><a href="chapter-polygon-data.html#cb97-3" tabindex="-1"></a>  <span class="dv">5070</span></span>
<span id="cb97-4"><a href="chapter-polygon-data.html#cb97-4" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="exploratory-analysis-with-sf" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Exploratory Analysis with <code>sf</code><a href="chapter-polygon-data.html#exploratory-analysis-with-sf" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="plot-single" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Plot (Single)<a href="chapter-polygon-data.html#plot-single" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With the data prepared, plot the wildfire smoke plume polygons with <code>ggplot2::ggplot()</code>.</p>
<p>Now that the parameters of interest and coordinate reference system have been prepared, create a plot with <code>ggplot2::ggplot()</code>. Identifying the data set to be plotted within the <code>geom_sf()</code> argument informs the function that the data is an <code>sf</code> object.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="chapter-polygon-data.html#cb98-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb98-2"><a href="chapter-polygon-data.html#cb98-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_sf</span>(</span>
<span id="cb98-3"><a href="chapter-polygon-data.html#cb98-3" tabindex="-1"></a>    <span class="at">data =</span> smoke_sf,</span>
<span id="cb98-4"><a href="chapter-polygon-data.html#cb98-4" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill =</span> Density)</span>
<span id="cb98-5"><a href="chapter-polygon-data.html#cb98-5" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb98-6"><a href="chapter-polygon-data.html#cb98-6" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="st">&quot;Smoke Density&quot;</span>,</span>
<span id="cb98-7"><a href="chapter-polygon-data.html#cb98-7" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;lightgreen&quot;</span>, <span class="st">&quot;lightgoldenrod&quot;</span>, <span class="st">&quot;tomato&quot;</span>)</span>
<span id="cb98-8"><a href="chapter-polygon-data.html#cb98-8" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb98-9"><a href="chapter-polygon-data.html#cb98-9" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">&quot;Wildfire Smoke Plumes&quot;</span>) <span class="sc">+</span></span>
<span id="cb98-10"><a href="chapter-polygon-data.html#cb98-10" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">theme_pubr</span>(<span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb98-11"><a href="chapter-polygon-data.html#cb98-11" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb98-12"><a href="chapter-polygon-data.html#cb98-12" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">grids</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<p>The wildfire smoke plume polygons are clearly visible and colored according to their individual smoke density classification. This plot, however, is difficult to interpret for two reasons. First, there are multiple polygons for each smoke density classification. Multiple borders and overlapping polygons with the same smoke density type can be confusing. To make the polygons more clear, individual polygons for each smoke density classification can be combined.</p>
<div class="warning">
<p>For the purposes of these exploratory analyses, the satellite travelling direction and time of collection will be ignored.</p>
</div>
</div>
<div id="union" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Union<a href="chapter-polygon-data.html#union" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Individual polygons can be unioned (combined) into one multi-part polygon with <code>sf::st_union</code>. The <code>group_by(Density)</code> argument specifies that the polygons should be combined based on the value stored in <code>$Density</code>. Adding the <code>Date = paste0(...</code> argument within the <code>dplyr::summarise()</code> function creates a parameter to store the date based on the year, month, and day of the data.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="chapter-polygon-data.html#cb99-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb99-2"><a href="chapter-polygon-data.html#cb99-2" tabindex="-1"></a>smoke_sf_density <span class="ot">&lt;-</span></span>
<span id="cb99-3"><a href="chapter-polygon-data.html#cb99-3" tabindex="-1"></a>  smoke_sf <span class="sc">%&gt;%</span></span>
<span id="cb99-4"><a href="chapter-polygon-data.html#cb99-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Density) <span class="sc">%&gt;%</span></span>
<span id="cb99-5"><a href="chapter-polygon-data.html#cb99-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb99-6"><a href="chapter-polygon-data.html#cb99-6" tabindex="-1"></a>    <span class="at">geometry =</span> sf<span class="sc">::</span><span class="fu">st_union</span>(geometry),</span>
<span id="cb99-7"><a href="chapter-polygon-data.html#cb99-7" tabindex="-1"></a>    <span class="at">Date =</span> <span class="fu">paste0</span>(</span>
<span id="cb99-8"><a href="chapter-polygon-data.html#cb99-8" tabindex="-1"></a>      year,</span>
<span id="cb99-9"><a href="chapter-polygon-data.html#cb99-9" tabindex="-1"></a>      month,</span>
<span id="cb99-10"><a href="chapter-polygon-data.html#cb99-10" tabindex="-1"></a>      day</span>
<span id="cb99-11"><a href="chapter-polygon-data.html#cb99-11" tabindex="-1"></a>    )</span>
<span id="cb99-12"><a href="chapter-polygon-data.html#cb99-12" tabindex="-1"></a>  )</span></code></pre></div>
<p>The resulting data set contains three multi-polygons, a column for the smoke plume classification, and a column for the date.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="chapter-polygon-data.html#cb100-1" tabindex="-1"></a>smoke_sf_density</span></code></pre></div>
<pre><code>## Simple feature collection with 3 features and 2 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -3260097 ymin: -1003068 xmax: 5993172 ymax: 6112717
## Projected CRS: NAD83 / Conus Albers
## # A tibble: 3 × 3
##   Density                                                         geometry Date 
##   &lt;fct&gt;                                                 &lt;MULTIPOLYGON [m]&gt; &lt;chr&gt;
## 1 Light   (((84357.22 1261681, 98970.86 1259451, 125379.3 1249659, 126431… 2023…
## 2 Medium  (((-1999749 1735020, -2007784 1687042, -2022469 1654525, -20389… 2023…
## 3 Heavy   (((45040.64 855923.7, 51735 842331, 52850.75 825751, 53427.35 8… 2023…</code></pre>
<p>Creating a new plot with <code>smoke_sf_density</code>.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="chapter-polygon-data.html#cb102-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb102-2"><a href="chapter-polygon-data.html#cb102-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_sf</span>(</span>
<span id="cb102-3"><a href="chapter-polygon-data.html#cb102-3" tabindex="-1"></a>    <span class="at">data =</span> smoke_sf_density,</span>
<span id="cb102-4"><a href="chapter-polygon-data.html#cb102-4" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill =</span> Density)</span>
<span id="cb102-5"><a href="chapter-polygon-data.html#cb102-5" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb102-6"><a href="chapter-polygon-data.html#cb102-6" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="st">&quot;Smoke Density&quot;</span>,</span>
<span id="cb102-7"><a href="chapter-polygon-data.html#cb102-7" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;lightgreen&quot;</span>, <span class="st">&quot;lightgoldenrod&quot;</span>, <span class="st">&quot;tomato&quot;</span>)</span>
<span id="cb102-8"><a href="chapter-polygon-data.html#cb102-8" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb102-9"><a href="chapter-polygon-data.html#cb102-9" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">&quot;Wildfire Smoke Plumes (unioned)&quot;</span>) <span class="sc">+</span></span>
<span id="cb102-10"><a href="chapter-polygon-data.html#cb102-10" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">theme_pubr</span>(<span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb102-11"><a href="chapter-polygon-data.html#cb102-11" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb102-12"><a href="chapter-polygon-data.html#cb102-12" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">grids</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<p>The plot is still difficult to interpret because it lacks geospatial context. The grid lines provide latitude and longitude references, but physical or geopolitical boundaries can help show where the wildfire smoke plumes are relative to the study area of interest. To provide geospatial context to the wildfire smoke plume polygons, we can add the United States state boundary polygons to the plot.</p>
</div>
<div id="chapter-polygon-plot-multiple-sf" class="section level3 hasAnchor" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Plot (Multiple)<a href="chapter-polygon-data.html#chapter-polygon-plot-multiple-sf" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The steps taken to access, download, unzip, and import the United States state boundary data are the same as those taken for the wildfire smoke plume coverage data. Refer to Sections <a href="chapter-polygon-data.html#chapter-polygon-access">Access, Download, and Unzip</a> and <a href="#chapter-polygon-import">Import</a> for detailed descriptions.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="chapter-polygon-data.html#cb103-1" tabindex="-1"></a>url_states <span class="ot">&lt;-</span></span>
<span id="cb103-2"><a href="chapter-polygon-data.html#cb103-2" tabindex="-1"></a>  <span class="st">&quot;https://www2.census.gov/geo/tiger/GENZ2018/shp/cb_2018_us_state_500k.zip&quot;</span></span>
<span id="cb103-3"><a href="chapter-polygon-data.html#cb103-3" tabindex="-1"></a></span>
<span id="cb103-4"><a href="chapter-polygon-data.html#cb103-4" tabindex="-1"></a>destination_states <span class="ot">&lt;-</span> <span class="st">&quot;./dataset/states/states.zip&quot;</span></span>
<span id="cb103-5"><a href="chapter-polygon-data.html#cb103-5" tabindex="-1"></a></span>
<span id="cb103-6"><a href="chapter-polygon-data.html#cb103-6" tabindex="-1"></a><span class="fu">download.file</span>(</span>
<span id="cb103-7"><a href="chapter-polygon-data.html#cb103-7" tabindex="-1"></a>  url_states,</span>
<span id="cb103-8"><a href="chapter-polygon-data.html#cb103-8" tabindex="-1"></a>  destination_states</span>
<span id="cb103-9"><a href="chapter-polygon-data.html#cb103-9" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="chapter-polygon-data.html#cb104-1" tabindex="-1"></a><span class="fu">unzip</span>(</span>
<span id="cb104-2"><a href="chapter-polygon-data.html#cb104-2" tabindex="-1"></a>  <span class="st">&quot;./dataset/states/states.zip&quot;</span>,</span>
<span id="cb104-3"><a href="chapter-polygon-data.html#cb104-3" tabindex="-1"></a>  <span class="at">list =</span> <span class="cn">TRUE</span></span>
<span id="cb104-4"><a href="chapter-polygon-data.html#cb104-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>##                                   Name  Length                Date
## 1 cb_2018_us_state_500k.shp.ea.iso.xml   17905 2019-04-15 12:48:00
## 2    cb_2018_us_state_500k.shp.iso.xml   32982 2019-04-15 12:48:00
## 3            cb_2018_us_state_500k.shp 4721868 2019-04-15 11:55:00
## 4            cb_2018_us_state_500k.shx     548 2019-04-15 11:55:00
## 5            cb_2018_us_state_500k.dbf    9058 2019-04-15 11:55:00
## 6            cb_2018_us_state_500k.prj     165 2019-04-15 11:55:00
## 7            cb_2018_us_state_500k.cpg       5 2019-04-15 11:55:00</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="chapter-polygon-data.html#cb106-1" tabindex="-1"></a><span class="fu">unzip</span>(</span>
<span id="cb106-2"><a href="chapter-polygon-data.html#cb106-2" tabindex="-1"></a>  <span class="st">&quot;./dataset/states/states.zip&quot;</span>,</span>
<span id="cb106-3"><a href="chapter-polygon-data.html#cb106-3" tabindex="-1"></a>  <span class="at">exdir =</span> <span class="st">&quot;./dataset/states/&quot;</span></span>
<span id="cb106-4"><a href="chapter-polygon-data.html#cb106-4" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="chapter-polygon-data.html#cb107-1" tabindex="-1"></a><span class="fu">list.files</span>(<span class="st">&quot;./dataset/states/&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;cb_2018_us_state_500k.cpg&quot;           
## [2] &quot;cb_2018_us_state_500k.dbf&quot;           
## [3] &quot;cb_2018_us_state_500k.prj&quot;           
## [4] &quot;cb_2018_us_state_500k.shp&quot;           
## [5] &quot;cb_2018_us_state_500k.shp.ea.iso.xml&quot;
## [6] &quot;cb_2018_us_state_500k.shp.iso.xml&quot;   
## [7] &quot;cb_2018_us_state_500k.shx&quot;           
## [8] &quot;states.zip&quot;</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="chapter-polygon-data.html#cb109-1" tabindex="-1"></a>states_sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_read</span>(<span class="st">&quot;./dataset/states/cb_2018_us_state_500k.shp&quot;</span>)</span></code></pre></div>
<pre><code>## Reading layer `cb_2018_us_state_500k&#39; from data source 
##   `/home/runner/work/PCOR_bookdown_tools/PCOR_bookdown_tools/dataset/states/cb_2018_us_state_500k.shp&#39; 
##   using driver `ESRI Shapefile&#39;
## Simple feature collection with 56 features and 9 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -179.1489 ymin: -14.5487 xmax: 179.7785 ymax: 71.36516
## Geodetic CRS:  NAD83</code></pre>
<p>Inspect the structure of <code>states_sf</code>.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="chapter-polygon-data.html#cb111-1" tabindex="-1"></a><span class="fu">str</span>(</span>
<span id="cb111-2"><a href="chapter-polygon-data.html#cb111-2" tabindex="-1"></a>  states_sf,</span>
<span id="cb111-3"><a href="chapter-polygon-data.html#cb111-3" tabindex="-1"></a>  <span class="at">vec.len =</span> <span class="dv">2</span></span>
<span id="cb111-4"><a href="chapter-polygon-data.html#cb111-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Classes &#39;sf&#39; and &#39;data.frame&#39;:   56 obs. of  10 variables:
##  $ STATEFP : chr  &quot;28&quot; &quot;37&quot; ...
##  $ STATENS : chr  &quot;01779790&quot; &quot;01027616&quot; ...
##  $ AFFGEOID: chr  &quot;0400000US28&quot; &quot;0400000US37&quot; ...
##  $ GEOID   : chr  &quot;28&quot; &quot;37&quot; ...
##  $ STUSPS  : chr  &quot;MS&quot; &quot;NC&quot; ...
##  $ NAME    : chr  &quot;Mississippi&quot; &quot;North Carolina&quot; ...
##  $ LSAD    : chr  &quot;00&quot; &quot;00&quot; ...
##  $ ALAND   : num  1.22e+11 1.26e+11 ...
##  $ AWATER  : num  3.93e+09 1.35e+10 ...
##  $ geometry:sfc_MULTIPOLYGON of length 56; first list element: List of 8
##   ..$ :List of 1
##   .. ..$ : num [1:16, 1:2] -88.5 -88.5 ...
##   ..$ :List of 1
##   .. ..$ : num [1:27, 1:2] -88.6 -88.6 ...
##   ..$ :List of 1
##   .. ..$ : num [1:27, 1:2] -88.8 -88.8 ...
##   ..$ :List of 1
##   .. ..$ : num [1:19, 1:2] -88.9 -88.9 ...
##   ..$ :List of 1
##   .. ..$ : num [1:8, 1:2] -88.9 -88.9 ...
##   ..$ :List of 1
##   .. ..$ : num [1:12, 1:2] -89 -89 ...
##   ..$ :List of 1
##   .. ..$ : num [1:27, 1:2] -89.1 -89.1 ...
##   ..$ :List of 1
##   .. ..$ : num [1:2713, 1:2] -91.7 -91.7 ...
##   ..- attr(*, &quot;class&quot;)= chr [1:3] &quot;XY&quot; &quot;MULTIPOLYGON&quot; ...
##  - attr(*, &quot;sf_column&quot;)= chr &quot;geometry&quot;
##  - attr(*, &quot;agr&quot;)= Factor w/ 3 levels &quot;constant&quot;,&quot;aggregate&quot;,..: NA NA NA NA NA ...
##   ..- attr(*, &quot;names&quot;)= chr [1:9] &quot;STATEFP&quot; &quot;STATENS&quot; ...</code></pre>
<p>For the purpose of these exploratory analyses, only the conterminous United States (CONUS) will be used. Subset <code>states_sf</code> to remove Alaska, Hawaii, and United States territories.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="chapter-polygon-data.html#cb113-1" tabindex="-1"></a>remove <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb113-2"><a href="chapter-polygon-data.html#cb113-2" tabindex="-1"></a>  <span class="st">&quot;Alaska&quot;</span>,</span>
<span id="cb113-3"><a href="chapter-polygon-data.html#cb113-3" tabindex="-1"></a>  <span class="st">&quot;Hawaii&quot;</span>,</span>
<span id="cb113-4"><a href="chapter-polygon-data.html#cb113-4" tabindex="-1"></a>  <span class="st">&quot;Puerto Rico&quot;</span>,</span>
<span id="cb113-5"><a href="chapter-polygon-data.html#cb113-5" tabindex="-1"></a>  <span class="st">&quot;United States Virgin Islands&quot;</span>,</span>
<span id="cb113-6"><a href="chapter-polygon-data.html#cb113-6" tabindex="-1"></a>  <span class="st">&quot;Commonwealth of the Northern Mariana Islands&quot;</span>,</span>
<span id="cb113-7"><a href="chapter-polygon-data.html#cb113-7" tabindex="-1"></a>  <span class="st">&quot;Guam&quot;</span>,</span>
<span id="cb113-8"><a href="chapter-polygon-data.html#cb113-8" tabindex="-1"></a>  <span class="st">&quot;American Samoa&quot;</span></span>
<span id="cb113-9"><a href="chapter-polygon-data.html#cb113-9" tabindex="-1"></a>)</span>
<span id="cb113-10"><a href="chapter-polygon-data.html#cb113-10" tabindex="-1"></a></span>
<span id="cb113-11"><a href="chapter-polygon-data.html#cb113-11" tabindex="-1"></a>conus_sf <span class="ot">&lt;-</span> <span class="fu">subset</span>(</span>
<span id="cb113-12"><a href="chapter-polygon-data.html#cb113-12" tabindex="-1"></a>  states_sf,</span>
<span id="cb113-13"><a href="chapter-polygon-data.html#cb113-13" tabindex="-1"></a>  <span class="sc">!</span>NAME <span class="sc">%in%</span> remove</span>
<span id="cb113-14"><a href="chapter-polygon-data.html#cb113-14" tabindex="-1"></a>)</span></code></pre></div>
<p>Check the coordinate reference system.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="chapter-polygon-data.html#cb114-1" tabindex="-1"></a>sf<span class="sc">::</span><span class="fu">st_crs</span>(conus_sf)</span></code></pre></div>
<pre><code>## Coordinate Reference System:
##   User input: NAD83 
##   wkt:
## GEOGCRS[&quot;NAD83&quot;,
##     DATUM[&quot;North American Datum 1983&quot;,
##         ELLIPSOID[&quot;GRS 1980&quot;,6378137,298.257222101,
##             LENGTHUNIT[&quot;metre&quot;,1]]],
##     PRIMEM[&quot;Greenwich&quot;,0,
##         ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
##     CS[ellipsoidal,2],
##         AXIS[&quot;latitude&quot;,north,
##             ORDER[1],
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
##         AXIS[&quot;longitude&quot;,east,
##             ORDER[2],
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
##     ID[&quot;EPSG&quot;,4269]]</code></pre>
<div class="important">
<p>When analyzing multiple spatial data sets together, all data sets must have the same coordinate reference system or projected coordinate system.</p>
</div>
<p>Transform <code>conus_sf</code> to match the projected coordinate system of the <code>smoke_sf_density</code> data set.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="chapter-polygon-data.html#cb116-1" tabindex="-1"></a>conus_sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_transform</span>(</span>
<span id="cb116-2"><a href="chapter-polygon-data.html#cb116-2" tabindex="-1"></a>  conus_sf,</span>
<span id="cb116-3"><a href="chapter-polygon-data.html#cb116-3" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_crs</span>(smoke_sf_density)</span>
<span id="cb116-4"><a href="chapter-polygon-data.html#cb116-4" tabindex="-1"></a>)</span></code></pre></div>
<p>Plot the conterminous United States state boundaries.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="chapter-polygon-data.html#cb117-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb117-2"><a href="chapter-polygon-data.html#cb117-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_sf</span>(<span class="at">data =</span> conus_sf) <span class="sc">+</span></span>
<span id="cb117-3"><a href="chapter-polygon-data.html#cb117-3" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">&quot;Coterminous United States&#39; State Boundaries&quot;</span>) <span class="sc">+</span></span>
<span id="cb117-4"><a href="chapter-polygon-data.html#cb117-4" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb117-5"><a href="chapter-polygon-data.html#cb117-5" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb117-6"><a href="chapter-polygon-data.html#cb117-6" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">grids</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<p>With the wildfire smoke plume and conterminous United States polygons imported and prepared, ensure that they have the same coordinate reference system.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="chapter-polygon-data.html#cb118-1" tabindex="-1"></a>sf<span class="sc">::</span><span class="fu">st_crs</span>(smoke_sf_density) <span class="sc">==</span> sf<span class="sc">::</span><span class="fu">st_crs</span>(conus_sf)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Create a plot which shows the distribution of wildfire smoke plumes over the conterminous United States state boundaries.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="chapter-polygon-data.html#cb120-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb120-2"><a href="chapter-polygon-data.html#cb120-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_sf</span>(</span>
<span id="cb120-3"><a href="chapter-polygon-data.html#cb120-3" tabindex="-1"></a>    <span class="at">data =</span> smoke_sf_density,</span>
<span id="cb120-4"><a href="chapter-polygon-data.html#cb120-4" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill =</span> Density)</span>
<span id="cb120-5"><a href="chapter-polygon-data.html#cb120-5" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb120-6"><a href="chapter-polygon-data.html#cb120-6" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="st">&quot;Smoke Density&quot;</span>,</span>
<span id="cb120-7"><a href="chapter-polygon-data.html#cb120-7" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;lightgreen&quot;</span>, <span class="st">&quot;lightgoldenrod&quot;</span>, <span class="st">&quot;tomato&quot;</span>)</span>
<span id="cb120-8"><a href="chapter-polygon-data.html#cb120-8" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb120-9"><a href="chapter-polygon-data.html#cb120-9" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_sf</span>(</span>
<span id="cb120-10"><a href="chapter-polygon-data.html#cb120-10" tabindex="-1"></a>    <span class="at">data =</span> conus_sf,</span>
<span id="cb120-11"><a href="chapter-polygon-data.html#cb120-11" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span></span>
<span id="cb120-12"><a href="chapter-polygon-data.html#cb120-12" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb120-13"><a href="chapter-polygon-data.html#cb120-13" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">&quot;Wildfire Smoke Plumes (with states)&quot;</span>) <span class="sc">+</span></span>
<span id="cb120-14"><a href="chapter-polygon-data.html#cb120-14" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">theme_pubr</span>(<span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb120-15"><a href="chapter-polygon-data.html#cb120-15" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb120-16"><a href="chapter-polygon-data.html#cb120-16" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">grids</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-60-1.png" width="672" /></p>
<p>This plot provides important geospatial context for understanding where the wildfire smoke plumes are in relation to the study area of interest.</p>
</div>
<div id="crop" class="section level3 hasAnchor" number="3.4.4">
<h3><span class="header-section-number">3.4.4</span> Crop<a href="chapter-polygon-data.html#crop" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>sf::st_crop()</code> function can be used to reduce the extent of a set of polygons to a specific rectangle, typically the bounding box of another spatial data set. In this example we can crop the <code>smoke_sf_density</code> polygons to the bounding box surrounding the conterminous United States.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="chapter-polygon-data.html#cb121-1" tabindex="-1"></a>smoke_sf_crop <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_crop</span>(</span>
<span id="cb121-2"><a href="chapter-polygon-data.html#cb121-2" tabindex="-1"></a>  smoke_sf_density,</span>
<span id="cb121-3"><a href="chapter-polygon-data.html#cb121-3" tabindex="-1"></a>  conus_sf</span>
<span id="cb121-4"><a href="chapter-polygon-data.html#cb121-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Warning: attribute variables are assumed to be spatially constant throughout
## all geometries</code></pre>
<p>Plot the cropped wildfire smoke plume polygons and the conterminous United States state boundaries.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="chapter-polygon-data.html#cb123-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb123-2"><a href="chapter-polygon-data.html#cb123-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_sf</span>(</span>
<span id="cb123-3"><a href="chapter-polygon-data.html#cb123-3" tabindex="-1"></a>    <span class="at">data =</span> smoke_sf_crop,</span>
<span id="cb123-4"><a href="chapter-polygon-data.html#cb123-4" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill =</span> Density)</span>
<span id="cb123-5"><a href="chapter-polygon-data.html#cb123-5" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb123-6"><a href="chapter-polygon-data.html#cb123-6" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="st">&quot;Smoke Density&quot;</span>,</span>
<span id="cb123-7"><a href="chapter-polygon-data.html#cb123-7" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;lightgreen&quot;</span>, <span class="st">&quot;lightgoldenrod&quot;</span>, <span class="st">&quot;tomato&quot;</span>)</span>
<span id="cb123-8"><a href="chapter-polygon-data.html#cb123-8" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb123-9"><a href="chapter-polygon-data.html#cb123-9" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_sf</span>(</span>
<span id="cb123-10"><a href="chapter-polygon-data.html#cb123-10" tabindex="-1"></a>    <span class="at">data =</span> conus_sf,</span>
<span id="cb123-11"><a href="chapter-polygon-data.html#cb123-11" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span></span>
<span id="cb123-12"><a href="chapter-polygon-data.html#cb123-12" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb123-13"><a href="chapter-polygon-data.html#cb123-13" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">&quot;Wildfire Smoke Plumes (cropped)&quot;</span>) <span class="sc">+</span></span>
<span id="cb123-14"><a href="chapter-polygon-data.html#cb123-14" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">theme_pubr</span>(<span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb123-15"><a href="chapter-polygon-data.html#cb123-15" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb123-16"><a href="chapter-polygon-data.html#cb123-16" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">grids</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
</div>
</div>
<div id="data-preparation-with-terra" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Data Preparation with <code>terra</code><a href="chapter-polygon-data.html#data-preparation-with-terra" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section will focus on exploratory analyses with polygon data using the <code>terra</code> package <span class="citation">(<a href="#ref-r-terra">9</a>)</span>.</p>
<div id="import-2" class="section level3 hasAnchor" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Import<a href="chapter-polygon-data.html#import-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that the contents of the zip files have been saved on your machine and the data files of interest have been identified, import both the wildfire smoke plume coverage data and the United States state boundary data with <code>terra::vect()</code>.</p>
<div class="note">
<p>See Sections <a href="chapter-polygon-data.html#chapter-polygon-access">Access, Download, and Unzip</a> and <a href="chapter-polygon-data.html#chapter-polygon-plot-multiple-sf">Plot (Multiple)</a> for obtaining the wildfire smoke plume coverage and United States state boundary data sets, respectively.</p>
</div>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="chapter-polygon-data.html#cb124-1" tabindex="-1"></a>smoke_t <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">vect</span>(<span class="st">&quot;./dataset/noaa/hms_smoke20230901.shp&quot;</span>)</span>
<span id="cb124-2"><a href="chapter-polygon-data.html#cb124-2" tabindex="-1"></a>states_t <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">vect</span>(<span class="st">&quot;./dataset/states/cb_2018_us_state_500k.shp&quot;</span>)</span></code></pre></div>
</div>
<div id="inspect-structure-2" class="section level3 hasAnchor" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Inspect Structure<a href="chapter-polygon-data.html#inspect-structure-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Inspect the structures of <code>smoke_t</code> and <code>states_t</code> to see their classes, column names, and column classes.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="chapter-polygon-data.html#cb125-1" tabindex="-1"></a>smoke_t</span></code></pre></div>
<pre><code>##  class       : SpatVector 
##  geometry    : polygons 
##  dimensions  : 58, 4  (geometries, attributes)
##  extent      : -149.8003, -13.8847, 13.58187, 75.17942  (xmin, xmax, ymin, ymax)
##  source      : hms_smoke20230901.shp
##  coord. ref. : lon/lat WGS 84 (EPSG:4326) 
##  names       : Satellite        Start          End Density
##  type        :     &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;
##  values      : GOES-EAST 2023244 0900 2023244 1300   Light
##                GOES-EAST 2023244 1300 2023244 1700   Light
##                GOES-EAST 2023244 1300 2023244 1700   Light</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="chapter-polygon-data.html#cb127-1" tabindex="-1"></a>states_t</span></code></pre></div>
<pre><code>##  class       : SpatVector 
##  geometry    : polygons 
##  dimensions  : 56, 9  (geometries, attributes)
##  extent      : -179.1489, 179.7785, -14.5487, 71.36516  (xmin, xmax, ymin, ymax)
##  source      : cb_2018_us_state_500k.shp
##  coord. ref. : lon/lat NAD83 (EPSG:4269) 
##  names       : STATEFP  STATENS    AFFGEOID GEOID STUSPS           NAME  LSAD
##  type        :   &lt;chr&gt;    &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;          &lt;chr&gt; &lt;chr&gt;
##  values      :      28 01779790 0400000US28    28     MS    Mississippi    00
##                     37 01027616 0400000US37    37     NC North Carolina    00
##                     40 01102857 0400000US40    40     OK       Oklahoma    00
##      ALAND    AWATER
##      &lt;num&gt;     &lt;num&gt;
##  1.215e+11 3.927e+09
##  1.259e+11 1.347e+10
##  1.777e+11 3.375e+09</code></pre>
<p>Both <code>smoke_t</code> and <code>states_t</code> have native spatial features. These are reflected by the type of spatial data in <code>geometry:</code>, and the spatial attributes <code>extent:</code> and <code>coord. ref.:</code></p>
</div>
<div id="chapter-polygon-terra-reclassify" class="section level3 hasAnchor" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Reclassify<a href="chapter-polygon-data.html#chapter-polygon-terra-reclassify" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The main parameter of interest in this data set is <code>$Density</code>, which discretely categorizes each wildfire smoke plume as “Light”, “Medium”, or “Heavy”. Checking its class shows that <code>$Density</code> is class character.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="chapter-polygon-data.html#cb129-1" tabindex="-1"></a><span class="fu">class</span>(smoke_t<span class="sc">$</span>Density)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p>Nominal data, data without fixed order or rank system, can be stored as class character (i.e., State names). However, it is best to store ordinal data as class factor for conducting analyses in R.</p>
<p>Converting data from class character to class factor can be done with <code>factor()</code>. The <code>levels = c()</code> argument in the function specifies both the level names and the ranked order of the levels.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="chapter-polygon-data.html#cb131-1" tabindex="-1"></a>smoke_t<span class="sc">$</span>Density <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb131-2"><a href="chapter-polygon-data.html#cb131-2" tabindex="-1"></a>  smoke_t<span class="sc">$</span>Density,</span>
<span id="cb131-3"><a href="chapter-polygon-data.html#cb131-3" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Light&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Heavy&quot;</span>)</span>
<span id="cb131-4"><a href="chapter-polygon-data.html#cb131-4" tabindex="-1"></a>)</span></code></pre></div>
<p>Check the class of <code>$Density</code> again to ensure proper reclassification.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="chapter-polygon-data.html#cb132-1" tabindex="-1"></a><span class="fu">class</span>(smoke_t<span class="sc">$</span>Density)</span></code></pre></div>
<pre><code>## [1] &quot;factor&quot;</code></pre>
<p>For the purpose of these exploratory analyses, only the conterminous United States (CONUS) will be used. Subset <code>states_t</code> to remove Alaska, Hawaii, and the United States territories.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="chapter-polygon-data.html#cb134-1" tabindex="-1"></a>remove <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb134-2"><a href="chapter-polygon-data.html#cb134-2" tabindex="-1"></a>  <span class="st">&quot;Alaska&quot;</span>,</span>
<span id="cb134-3"><a href="chapter-polygon-data.html#cb134-3" tabindex="-1"></a>  <span class="st">&quot;Hawaii&quot;</span>,</span>
<span id="cb134-4"><a href="chapter-polygon-data.html#cb134-4" tabindex="-1"></a>  <span class="st">&quot;Puerto Rico&quot;</span>,</span>
<span id="cb134-5"><a href="chapter-polygon-data.html#cb134-5" tabindex="-1"></a>  <span class="st">&quot;United States Virgin Islands&quot;</span>,</span>
<span id="cb134-6"><a href="chapter-polygon-data.html#cb134-6" tabindex="-1"></a>  <span class="st">&quot;Commonwealth of the Northern Mariana Islands&quot;</span>,</span>
<span id="cb134-7"><a href="chapter-polygon-data.html#cb134-7" tabindex="-1"></a>  <span class="st">&quot;Guam&quot;</span>,</span>
<span id="cb134-8"><a href="chapter-polygon-data.html#cb134-8" tabindex="-1"></a>  <span class="st">&quot;American Samoa&quot;</span></span>
<span id="cb134-9"><a href="chapter-polygon-data.html#cb134-9" tabindex="-1"></a>)</span>
<span id="cb134-10"><a href="chapter-polygon-data.html#cb134-10" tabindex="-1"></a></span>
<span id="cb134-11"><a href="chapter-polygon-data.html#cb134-11" tabindex="-1"></a>conus_t <span class="ot">&lt;-</span> <span class="fu">subset</span>(</span>
<span id="cb134-12"><a href="chapter-polygon-data.html#cb134-12" tabindex="-1"></a>  states_t,</span>
<span id="cb134-13"><a href="chapter-polygon-data.html#cb134-13" tabindex="-1"></a>  <span class="sc">!</span>states_t<span class="sc">$</span>NAME <span class="sc">%in%</span> remove</span>
<span id="cb134-14"><a href="chapter-polygon-data.html#cb134-14" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="coordinate-reference-system-and-projection-2" class="section level3 hasAnchor" number="3.5.4">
<h3><span class="header-section-number">3.5.4</span> Coordinate Reference System and Projection<a href="chapter-polygon-data.html#coordinate-reference-system-and-projection-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Check the coordinate reference systems of <code>SpatVector</code> objects with <code>terra::crs()</code>.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="chapter-polygon-data.html#cb135-1" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">crs</span>(</span>
<span id="cb135-2"><a href="chapter-polygon-data.html#cb135-2" tabindex="-1"></a>  smoke_t,</span>
<span id="cb135-3"><a href="chapter-polygon-data.html#cb135-3" tabindex="-1"></a>  <span class="at">describe =</span> <span class="cn">TRUE</span></span>
<span id="cb135-4"><a href="chapter-polygon-data.html#cb135-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>##     name authority code area       extent
## 1 WGS 84      EPSG 4326 &lt;NA&gt; NA, NA, ....</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="chapter-polygon-data.html#cb137-1" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">crs</span>(</span>
<span id="cb137-2"><a href="chapter-polygon-data.html#cb137-2" tabindex="-1"></a>  conus_t,</span>
<span id="cb137-3"><a href="chapter-polygon-data.html#cb137-3" tabindex="-1"></a>  <span class="at">describe =</span> <span class="cn">TRUE</span></span>
<span id="cb137-4"><a href="chapter-polygon-data.html#cb137-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>##    name authority code area       extent
## 1 NAD83      EPSG 4269 &lt;NA&gt; NA, NA, ....</code></pre>
<p>Both data sets have native coordinate reference systems which were imported during the <code>terra::vect()</code> step. The two data sets, however, have different coordinate reference systems from each other. The area of interest for these exploratory analyses is the conterminous United States, so we can project <code>smoke_t</code> and <code>conus_t</code> to the Albers Equal Area projected coordinate system (EPSG code: 5070).</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="chapter-polygon-data.html#cb139-1" tabindex="-1"></a>smoke_t_p <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">project</span>(</span>
<span id="cb139-2"><a href="chapter-polygon-data.html#cb139-2" tabindex="-1"></a>  smoke_t,</span>
<span id="cb139-3"><a href="chapter-polygon-data.html#cb139-3" tabindex="-1"></a>  <span class="st">&quot;EPSG:5070&quot;</span></span>
<span id="cb139-4"><a href="chapter-polygon-data.html#cb139-4" tabindex="-1"></a>)</span>
<span id="cb139-5"><a href="chapter-polygon-data.html#cb139-5" tabindex="-1"></a>conus_t_p <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">project</span>(</span>
<span id="cb139-6"><a href="chapter-polygon-data.html#cb139-6" tabindex="-1"></a>  conus_t,</span>
<span id="cb139-7"><a href="chapter-polygon-data.html#cb139-7" tabindex="-1"></a>  <span class="st">&quot;EPSG:5070&quot;</span></span>
<span id="cb139-8"><a href="chapter-polygon-data.html#cb139-8" tabindex="-1"></a>)</span></code></pre></div>
<p>Although both data sets were transformed to the same projected coordinate system, it is important to ensure that all data sets have the same coordinate reference system or projected coordinate system.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="chapter-polygon-data.html#cb140-1" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">crs</span>(smoke_t_p) <span class="sc">==</span> terra<span class="sc">::</span><span class="fu">crs</span>(conus_t_p)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
</div>
<div id="exploratory-analysis-with-terra" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Exploratory Analysis with <code>terra</code><a href="chapter-polygon-data.html#exploratory-analysis-with-terra" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="plot-multiple" class="section level3 hasAnchor" number="3.6.1">
<h3><span class="header-section-number">3.6.1</span> Plot (Multiple)<a href="chapter-polygon-data.html#plot-multiple" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Plot both data sets together in one plot with <code>ggplot2::ggplot()</code>.</p>
<p>Now that the parameters of interest and coordinate reference systems have been prepared, create a plot with <code>ggplot2::ggplot()</code>. Identifying the data sets to be plotted within the <code>tidyterra::geom_spatvector()</code> arguments informs the function that the data are <code>SpatVector</code> objects <span class="citation">(<a href="#ref-r-tidyterra">10</a>)</span>.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="chapter-polygon-data.html#cb142-1" tabindex="-1"></a><span class="fu">library</span>(tidyterra)</span>
<span id="cb142-2"><a href="chapter-polygon-data.html#cb142-2" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb142-3"><a href="chapter-polygon-data.html#cb142-3" tabindex="-1"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatvector</span>(</span>
<span id="cb142-4"><a href="chapter-polygon-data.html#cb142-4" tabindex="-1"></a>    <span class="at">data =</span> smoke_t_p,</span>
<span id="cb142-5"><a href="chapter-polygon-data.html#cb142-5" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill =</span> Density)</span>
<span id="cb142-6"><a href="chapter-polygon-data.html#cb142-6" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb142-7"><a href="chapter-polygon-data.html#cb142-7" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="st">&quot;Smoke Density&quot;</span>,</span>
<span id="cb142-8"><a href="chapter-polygon-data.html#cb142-8" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;lightgreen&quot;</span>, <span class="st">&quot;lightgoldenrod&quot;</span>, <span class="st">&quot;tomato&quot;</span>)</span>
<span id="cb142-9"><a href="chapter-polygon-data.html#cb142-9" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb142-10"><a href="chapter-polygon-data.html#cb142-10" tabindex="-1"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatvector</span>(</span>
<span id="cb142-11"><a href="chapter-polygon-data.html#cb142-11" tabindex="-1"></a>    <span class="at">data =</span> conus_t_p,</span>
<span id="cb142-12"><a href="chapter-polygon-data.html#cb142-12" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span></span>
<span id="cb142-13"><a href="chapter-polygon-data.html#cb142-13" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb142-14"><a href="chapter-polygon-data.html#cb142-14" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">&quot;Wildfire Smoke Plumes (with states)&quot;</span>) <span class="sc">+</span></span>
<span id="cb142-15"><a href="chapter-polygon-data.html#cb142-15" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">theme_pubr</span>(<span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb142-16"><a href="chapter-polygon-data.html#cb142-16" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb142-17"><a href="chapter-polygon-data.html#cb142-17" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">grids</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
<p>The wildfire smoke plume polygons are clearly visible and colored according to their individual smoke density classification. The plot, however, is difficult to interpret because there are multiple polygons for each smoke density classification. Multiple borders and overlapping polygons with the same smoke density type can be confusing. To make the polygons more clear, individual polygons for each smoke density classification can be combined.</p>
<div class="warning">
<p>For the purposes of these exploratory analyses, the satellite travelling direction and time of collection will be ignored.</p>
</div>
</div>
<div id="aggregate" class="section level3 hasAnchor" number="3.6.2">
<h3><span class="header-section-number">3.6.2</span> Aggregate<a href="chapter-polygon-data.html#aggregate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Individual polygons an be aggregated (combined) into one multi-part polygon with <code>terra::aggregate()</code>. The <code>by = "Density"</code> argument specifies that the polygons should be combined based on the value stored in <code>$Density</code>.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="chapter-polygon-data.html#cb143-1" tabindex="-1"></a>smoke_t_density <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">aggregate</span>(</span>
<span id="cb143-2"><a href="chapter-polygon-data.html#cb143-2" tabindex="-1"></a>  smoke_t_p,</span>
<span id="cb143-3"><a href="chapter-polygon-data.html#cb143-3" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">&quot;Density&quot;</span>,</span>
<span id="cb143-4"><a href="chapter-polygon-data.html#cb143-4" tabindex="-1"></a>  <span class="at">dissolve =</span> <span class="cn">TRUE</span></span>
<span id="cb143-5"><a href="chapter-polygon-data.html#cb143-5" tabindex="-1"></a>)</span></code></pre></div>
<p>Aggregating the polygons based on the values stored in the <code>$Density</code> column can result in the other columns containing <code>NA</code> values. To remove these columns, subset <code>smoke_t_density</code> to remove <code>$Satellite</code>, <code>$Start</code>, and <code>$End</code>.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="chapter-polygon-data.html#cb144-1" tabindex="-1"></a>smoke_t_density <span class="ot">&lt;-</span> smoke_t_density[</span>
<span id="cb144-2"><a href="chapter-polygon-data.html#cb144-2" tabindex="-1"></a>  <span class="fu">seq_len</span>(<span class="fu">nrow</span>(smoke_t_density)),</span>
<span id="cb144-3"><a href="chapter-polygon-data.html#cb144-3" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;Density&quot;</span>, <span class="st">&quot;agg_n&quot;</span>)</span>
<span id="cb144-4"><a href="chapter-polygon-data.html#cb144-4" tabindex="-1"></a>]</span></code></pre></div>
<p>The resulting data set contains three multi-polygons, a column for the smoke plume classification, and a count of the number of individual polygons that were aggregated to create the multi-polygon. This last column, <code>$agg_n</code> is automatically calculated by the <code>terra::aggregate()</code> function.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="chapter-polygon-data.html#cb145-1" tabindex="-1"></a>smoke_t_density</span></code></pre></div>
<pre><code>##  class       : SpatVector 
##  geometry    : polygons 
##  dimensions  : 3, 2  (geometries, attributes)
##  extent      : -3260097, 5993172, -1003068, 6112717  (xmin, xmax, ymin, ymax)
##  coord. ref. : NAD83 / Conus Albers (EPSG:5070) 
##  names       : Density agg_n
##  type        :  &lt;fact&gt; &lt;int&gt;
##  values      :   Light    37
##                 Medium    15
##                  Heavy     6</code></pre>
<p>Create a new plot with <code>smoke_t_density</code>.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="chapter-polygon-data.html#cb147-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb147-2"><a href="chapter-polygon-data.html#cb147-2" tabindex="-1"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatvector</span>(</span>
<span id="cb147-3"><a href="chapter-polygon-data.html#cb147-3" tabindex="-1"></a>    <span class="at">data =</span> smoke_t_density,</span>
<span id="cb147-4"><a href="chapter-polygon-data.html#cb147-4" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill =</span> Density)</span>
<span id="cb147-5"><a href="chapter-polygon-data.html#cb147-5" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb147-6"><a href="chapter-polygon-data.html#cb147-6" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="st">&quot;Smoke Density&quot;</span>,</span>
<span id="cb147-7"><a href="chapter-polygon-data.html#cb147-7" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;lightgreen&quot;</span>, <span class="st">&quot;lightgoldenrod&quot;</span>, <span class="st">&quot;tomato&quot;</span>)</span>
<span id="cb147-8"><a href="chapter-polygon-data.html#cb147-8" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb147-9"><a href="chapter-polygon-data.html#cb147-9" tabindex="-1"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatvector</span>(</span>
<span id="cb147-10"><a href="chapter-polygon-data.html#cb147-10" tabindex="-1"></a>    <span class="at">data =</span> conus_t_p,</span>
<span id="cb147-11"><a href="chapter-polygon-data.html#cb147-11" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span></span>
<span id="cb147-12"><a href="chapter-polygon-data.html#cb147-12" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb147-13"><a href="chapter-polygon-data.html#cb147-13" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">&quot;Wildfire Smoke Plumes (aggregated)&quot;</span>) <span class="sc">+</span></span>
<span id="cb147-14"><a href="chapter-polygon-data.html#cb147-14" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">theme_pubr</span>(<span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb147-15"><a href="chapter-polygon-data.html#cb147-15" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb147-16"><a href="chapter-polygon-data.html#cb147-16" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">grids</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-76-1.png" width="672" /></p>
</div>
<div id="crop-1" class="section level3 hasAnchor" number="3.6.3">
<h3><span class="header-section-number">3.6.3</span> Crop<a href="chapter-polygon-data.html#crop-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>terra::crop()</code> function can be used to reduce <code>SpatVector</code> to an area determined by another <code>SpatVector</code>. In this example, we can crop the <code>smoke_t_density</code> polygons to the conterminous United States state boundaries.</p>
<div class="note">
<p>Overlapping or self-intersecting polygons can occur with complex geometries or during data processing and transformation. Applying a negative buffer can help resolve these issues by slightly reducing the size of the polygons, thus eliminating problematic overlaps and intersections. This buffering adjustedment may affect statistical analyses, and therefore should be performed with caution.</p>
</div>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="chapter-polygon-data.html#cb148-1" tabindex="-1"></a>smoke_t_crop <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">crop</span>(</span>
<span id="cb148-2"><a href="chapter-polygon-data.html#cb148-2" tabindex="-1"></a>  smoke_t_density,</span>
<span id="cb148-3"><a href="chapter-polygon-data.html#cb148-3" tabindex="-1"></a>  terra<span class="sc">::</span><span class="fu">buffer</span>(conus_t_p, <span class="sc">-</span><span class="fl">0.0001</span>)</span>
<span id="cb148-4"><a href="chapter-polygon-data.html#cb148-4" tabindex="-1"></a>)</span></code></pre></div>
<p>Plot the cropped wildfire smoke plume polygons and the conterminous United States state boundaries.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="chapter-polygon-data.html#cb149-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb149-2"><a href="chapter-polygon-data.html#cb149-2" tabindex="-1"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatvector</span>(</span>
<span id="cb149-3"><a href="chapter-polygon-data.html#cb149-3" tabindex="-1"></a>    <span class="at">data =</span> smoke_t_crop,</span>
<span id="cb149-4"><a href="chapter-polygon-data.html#cb149-4" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill =</span> Density)</span>
<span id="cb149-5"><a href="chapter-polygon-data.html#cb149-5" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb149-6"><a href="chapter-polygon-data.html#cb149-6" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="st">&quot;Smoke Density&quot;</span>,</span>
<span id="cb149-7"><a href="chapter-polygon-data.html#cb149-7" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;lightgreen&quot;</span>, <span class="st">&quot;lightgoldenrod&quot;</span>, <span class="st">&quot;tomato&quot;</span>)</span>
<span id="cb149-8"><a href="chapter-polygon-data.html#cb149-8" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb149-9"><a href="chapter-polygon-data.html#cb149-9" tabindex="-1"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatvector</span>(</span>
<span id="cb149-10"><a href="chapter-polygon-data.html#cb149-10" tabindex="-1"></a>    <span class="at">data =</span> conus_t_p,</span>
<span id="cb149-11"><a href="chapter-polygon-data.html#cb149-11" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span></span>
<span id="cb149-12"><a href="chapter-polygon-data.html#cb149-12" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb149-13"><a href="chapter-polygon-data.html#cb149-13" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">&quot;Wildfire Smoke Plumes (cropped)&quot;</span>) <span class="sc">+</span></span>
<span id="cb149-14"><a href="chapter-polygon-data.html#cb149-14" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">theme_pubr</span>(<span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb149-15"><a href="chapter-polygon-data.html#cb149-15" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb149-16"><a href="chapter-polygon-data.html#cb149-16" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb149-17"><a href="chapter-polygon-data.html#cb149-17" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb149-18"><a href="chapter-polygon-data.html#cb149-18" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb149-19"><a href="chapter-polygon-data.html#cb149-19" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>()</span>
<span id="cb149-20"><a href="chapter-polygon-data.html#cb149-20" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-78-1.png" width="672" /></p>
</div>
<div id="zonal-statistics" class="section level3 hasAnchor" number="3.6.4">
<h3><span class="header-section-number">3.6.4</span> Zonal Statistics<a href="chapter-polygon-data.html#zonal-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Looking closely at the previous plot, it is clear that wildfire smoke plumes cover each state differently. The <code>terra</code> package can be used to identify which states are covered by each classification of wildfire smoke plumes.</p>
<p>The <code>terra::relate()</code> function can be used to identify spatial relationships between two <code>SpatVector</code> objects. The <code>relation = "intersects"</code> argument logically identifies if any portion of each state is or is not covered by each of the three wildfire smoke plume classification multi-polygons.</p>
<p>The output of <code>terra::relate()</code> is a wide matrix. The nested <code>data.frame()</code> and <code>t()</code> wrappers convert the output from a wide matrix to a long data frame, which is required to combine the results with the <code>conus_t</code> data set.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="chapter-polygon-data.html#cb150-1" tabindex="-1"></a>conus_smoke <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb150-2"><a href="chapter-polygon-data.html#cb150-2" tabindex="-1"></a>  <span class="fu">t</span>(</span>
<span id="cb150-3"><a href="chapter-polygon-data.html#cb150-3" tabindex="-1"></a>    terra<span class="sc">::</span><span class="fu">relate</span>(</span>
<span id="cb150-4"><a href="chapter-polygon-data.html#cb150-4" tabindex="-1"></a>      smoke_t_density,</span>
<span id="cb150-5"><a href="chapter-polygon-data.html#cb150-5" tabindex="-1"></a>      conus_t_p,</span>
<span id="cb150-6"><a href="chapter-polygon-data.html#cb150-6" tabindex="-1"></a>      <span class="at">relation =</span> <span class="st">&quot;intersects&quot;</span></span>
<span id="cb150-7"><a href="chapter-polygon-data.html#cb150-7" tabindex="-1"></a>    )</span>
<span id="cb150-8"><a href="chapter-polygon-data.html#cb150-8" tabindex="-1"></a>  )</span>
<span id="cb150-9"><a href="chapter-polygon-data.html#cb150-9" tabindex="-1"></a>)</span></code></pre></div>
<p>Set the column names of <code>conus_smoke</code> to match the smoke density classifications.</p>
<div class="note">
<p>The order of the columns in <code>conus_smoke</code> are based on the ordered factor levels in <code>smoke_t_density$Density</code> (see Section <a href="chapter-polygon-data.html#chapter-polygon-terra-reclassify">Reclassify</a>).</p>
</div>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="chapter-polygon-data.html#cb151-1" tabindex="-1"></a><span class="fu">colnames</span>(conus_smoke) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Light&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Heavy&quot;</span>)</span></code></pre></div>
<p>Combine the wildfire smoke plume indicator data frame with the the conterminous United States state boundaries data.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="chapter-polygon-data.html#cb152-1" tabindex="-1"></a>conus_t_p <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb152-2"><a href="chapter-polygon-data.html#cb152-2" tabindex="-1"></a>  conus_t_p,</span>
<span id="cb152-3"><a href="chapter-polygon-data.html#cb152-3" tabindex="-1"></a>  conus_smoke</span>
<span id="cb152-4"><a href="chapter-polygon-data.html#cb152-4" tabindex="-1"></a>)</span></code></pre></div>
<p>The <code>conus_t_p</code> data set now contains separate columns indicating the presence or absence of “Light”, “Medium”, and “Heavy” wildfire smoke plumes for each conterminous state.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="chapter-polygon-data.html#cb153-1" tabindex="-1"></a><span class="fu">names</span>(conus_t_p)</span></code></pre></div>
<pre><code>##  [1] &quot;STATEFP&quot;  &quot;STATENS&quot;  &quot;AFFGEOID&quot; &quot;GEOID&quot;    &quot;STUSPS&quot;   &quot;NAME&quot;    
##  [7] &quot;LSAD&quot;     &quot;ALAND&quot;    &quot;AWATER&quot;   &quot;Light&quot;    &quot;Medium&quot;   &quot;Heavy&quot;</code></pre>
</div>
<div id="plot-for-loop" class="section level3 hasAnchor" number="3.6.5">
<h3><span class="header-section-number">3.6.5</span> Plot (<code>for</code> Loop)<a href="chapter-polygon-data.html#plot-for-loop" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A <code>for</code> loop can be used to create indicator plots for each wildfire smoke plume classification. The layout of a <code>for</code> loop can look complicated, but it simply applies the same set of functions to a given list of inputs.</p>
<p>The list of inputs must first be created. As the goal is to plot each of the wildfire smoke plume density classifications, create a character vector of the three classification names.</p>
<p>This “list of inputs” must first be created. Store the three wildfire smoke plume classifications in a vector of class character.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="chapter-polygon-data.html#cb155-1" tabindex="-1"></a>dens_c <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Light&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Heavy&quot;</span>)</span></code></pre></div>
<p>Create a <code>for</code> loop that creates a plot for each wildfire smoke plume density stored within <code>dens_c</code>.</p>
<p>Code line 1 tells the <code>for</code> loop to apply the following functions to each observation in <code>dens_c</code>.</p>
<p>Code lines 3 through 9 define the plotting colors based on the wildfire smoke plume classification (<code>dens_c[d]</code>). As in previous plots, “Light” smoke plumes will be colored green, “Medium” smoke plumes will be covered yellow, and “Heavy” smoke plumes will be colored red.</p>
<p>Code lines 12 through 32 create the plot based on the wildfire smoke plume classification (<code>dens_c[d]</code>), and previously defined plotting colors (<code>color_values</code>).</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="chapter-polygon-data.html#cb156-1" tabindex="-1"></a><span class="cf">for</span> (d <span class="cf">in</span> <span class="fu">seq_along</span>(dens_c)) {</span>
<span id="cb156-2"><a href="chapter-polygon-data.html#cb156-2" tabindex="-1"></a>  <span class="co"># define color palette based on smoke density</span></span>
<span id="cb156-3"><a href="chapter-polygon-data.html#cb156-3" tabindex="-1"></a>  <span class="cf">if</span> (dens_c[d] <span class="sc">==</span> <span class="st">&quot;Light&quot;</span>) {</span>
<span id="cb156-4"><a href="chapter-polygon-data.html#cb156-4" tabindex="-1"></a>    color_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightgreen&quot;</span>)</span>
<span id="cb156-5"><a href="chapter-polygon-data.html#cb156-5" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (dens_c[d] <span class="sc">==</span> <span class="st">&quot;Medium&quot;</span>) {</span>
<span id="cb156-6"><a href="chapter-polygon-data.html#cb156-6" tabindex="-1"></a>    color_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightgoldenrod&quot;</span>)</span>
<span id="cb156-7"><a href="chapter-polygon-data.html#cb156-7" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (dens_c[d] <span class="sc">==</span> <span class="st">&quot;Heavy&quot;</span>) {</span>
<span id="cb156-8"><a href="chapter-polygon-data.html#cb156-8" tabindex="-1"></a>    color_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;tomato&quot;</span>)</span>
<span id="cb156-9"><a href="chapter-polygon-data.html#cb156-9" tabindex="-1"></a>  }</span>
<span id="cb156-10"><a href="chapter-polygon-data.html#cb156-10" tabindex="-1"></a></span>
<span id="cb156-11"><a href="chapter-polygon-data.html#cb156-11" tabindex="-1"></a>  <span class="co"># create plot</span></span>
<span id="cb156-12"><a href="chapter-polygon-data.html#cb156-12" tabindex="-1"></a>  <span class="fu">print</span>(</span>
<span id="cb156-13"><a href="chapter-polygon-data.html#cb156-13" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb156-14"><a href="chapter-polygon-data.html#cb156-14" tabindex="-1"></a>      tidyterra<span class="sc">::</span><span class="fu">geom_spatvector</span>(</span>
<span id="cb156-15"><a href="chapter-polygon-data.html#cb156-15" tabindex="-1"></a>        <span class="at">data =</span> conus_t_p,</span>
<span id="cb156-16"><a href="chapter-polygon-data.html#cb156-16" tabindex="-1"></a>        <span class="fu">aes_string</span>(<span class="at">fill =</span> dens_c[d])</span>
<span id="cb156-17"><a href="chapter-polygon-data.html#cb156-17" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb156-18"><a href="chapter-polygon-data.html#cb156-18" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(</span>
<span id="cb156-19"><a href="chapter-polygon-data.html#cb156-19" tabindex="-1"></a>        <span class="fu">paste0</span>(</span>
<span id="cb156-20"><a href="chapter-polygon-data.html#cb156-20" tabindex="-1"></a>          dens_c[d],</span>
<span id="cb156-21"><a href="chapter-polygon-data.html#cb156-21" tabindex="-1"></a>          <span class="st">&quot; Smoke Plume Coverage Present&quot;</span></span>
<span id="cb156-22"><a href="chapter-polygon-data.html#cb156-22" tabindex="-1"></a>        ),</span>
<span id="cb156-23"><a href="chapter-polygon-data.html#cb156-23" tabindex="-1"></a>        <span class="at">values =</span> color_values</span>
<span id="cb156-24"><a href="chapter-polygon-data.html#cb156-24" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb156-25"><a href="chapter-polygon-data.html#cb156-25" tabindex="-1"></a>      ggpubr<span class="sc">::</span><span class="fu">theme_pubr</span>(<span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb156-26"><a href="chapter-polygon-data.html#cb156-26" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb156-27"><a href="chapter-polygon-data.html#cb156-27" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb156-28"><a href="chapter-polygon-data.html#cb156-28" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb156-29"><a href="chapter-polygon-data.html#cb156-29" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb156-30"><a href="chapter-polygon-data.html#cb156-30" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_blank</span>()</span>
<span id="cb156-31"><a href="chapter-polygon-data.html#cb156-31" tabindex="-1"></a>      )</span>
<span id="cb156-32"><a href="chapter-polygon-data.html#cb156-32" tabindex="-1"></a>  )</span>
<span id="cb156-33"><a href="chapter-polygon-data.html#cb156-33" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-84-1.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-84-2.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-84-3.png" width="672" /></p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body">
<div id="ref-r-sf-1" class="csl-entry">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Pebesma, Edzer. 2018. <span>“<span class="nocase">Simple Features for <span>R</span>: Standardized Support for Spatial Vector Data</span>.”</span> <em><span>The R Journal</span></em> 10 (1): 439–46. <a href="https://doi.org/10.32614/RJ-2018-009">https://doi.org/10.32614/RJ-2018-009</a></div>
</div>
<div id="ref-r-terra" class="csl-entry">
<div class="csl-left-margin">9. </div><div class="csl-right-inline">Hijmans, Robert J. 2024. <em><span class="nocase">terra</span>: Spatial Data Analysis</em>. R Package Version 1.7-71. <a href="https://CRAN.R-project.org/package=terra">https://CRAN.R-project.org/package=terra</a></div>
</div>
<div id="ref-r-tidyterra" class="csl-entry">
<div class="csl-left-margin">10. </div><div class="csl-right-inline">Hernangómez, Diego. 2023. <span>“Using the <span class="nocase">tidyverse</span> with <span class="nocase">terra</span> Objects: The <span class="nocase">tidyterra</span> Package.”</span> <em>Journal of Open Source Software</em> 8 (91): 5751. <a href="https://doi.org/10.21105/joss.05751">https://doi.org/10.21105/joss.05751</a></div>
</div>
</div>
<!DOCTYPE html>
<script src="https://cdn.jsdelivr.net/npm/@xiee/utils/js/external-link.min.js" defer></script>
            </section>

          </div>
        </div>
      </div>
<a href="chapter-point-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter-raster-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": true,
    "facebook": false,
    "twitter": false,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": false
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section"
  }
});
});
</script>

</body>

</html>
