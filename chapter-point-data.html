<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Point Data | The CHORDS Toolkit for Health and Geospatial Exposures Research</title>
  <meta name="description" content="The CHORDS Toolkit provides guides, tools, and example code to support climate change and human health research." />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Point Data | The CHORDS Toolkit for Health and Geospatial Exposures Research" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="The CHORDS Toolkit provides guides, tools, and example code to support climate change and human health research." />
  <meta name="github-repo" content="NIEHS/PCOR_bookdown_tools" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Point Data | The CHORDS Toolkit for Health and Geospatial Exposures Research" />
  
  <meta name="twitter:description" content="The CHORDS Toolkit provides guides, tools, and example code to support climate change and human health research." />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter-getting-started-spatial.html"/>
<link rel="next" href="chapter-polygon-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">CHORDS Toolkit</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><strong>Introduction</strong></a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-chords"><i class="fa fa-check"></i>About CHORDS</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-this-toolkit"><i class="fa fa-check"></i>About This Toolkit</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="unit-geospatial-foundations.html"><a href="unit-geospatial-foundations.html"><i class="fa fa-check"></i><strong>Geospatial Data Foundations</strong></a></li>
<li class="chapter" data-level="1" data-path="chapter-getting-started-spatial.html"><a href="chapter-getting-started-spatial.html"><i class="fa fa-check"></i><b>1</b> Getting Started</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chapter-getting-started-spatial.html"><a href="chapter-getting-started-spatial.html#introduction-1"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="chapter-getting-started-spatial.html"><a href="chapter-getting-started-spatial.html#concepts-and-terminology"><i class="fa fa-check"></i><b>1.2</b> Concepts and Terminology</a></li>
<li class="chapter" data-level="1.3" data-path="chapter-getting-started-spatial.html"><a href="chapter-getting-started-spatial.html#datasets"><i class="fa fa-check"></i><b>1.3</b> Datasets</a></li>
<li class="chapter" data-level="1.4" data-path="chapter-getting-started-spatial.html"><a href="chapter-getting-started-spatial.html#r-packages"><i class="fa fa-check"></i><b>1.4</b> <code>R</code> Packages</a></li>
<li class="chapter" data-level="1.5" data-path="chapter-getting-started-spatial.html"><a href="chapter-getting-started-spatial.html#chapter-getting-started-spatial-resources"><i class="fa fa-check"></i><b>1.5</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter-point-data.html"><a href="chapter-point-data.html"><i class="fa fa-check"></i><b>2</b> Point Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter-point-data.html"><a href="chapter-point-data.html#introduction-2"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="chapter-point-data.html"><a href="chapter-point-data.html#access-download-and-unzip"><i class="fa fa-check"></i><b>2.2</b> Access, Download, and Unzip</a></li>
<li class="chapter" data-level="2.3" data-path="chapter-point-data.html"><a href="chapter-point-data.html#data-preparation"><i class="fa fa-check"></i><b>2.3</b> Data Preparation</a></li>
<li class="chapter" data-level="2.4" data-path="chapter-point-data.html"><a href="chapter-point-data.html#exploratory-analysis"><i class="fa fa-check"></i><b>2.4</b> Exploratory Analysis</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter-polygon-data.html"><a href="chapter-polygon-data.html"><i class="fa fa-check"></i><b>3</b> Polygon Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter-polygon-data.html"><a href="chapter-polygon-data.html#introduction-3"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="chapter-polygon-data.html"><a href="chapter-polygon-data.html#chapter-polygon-access"><i class="fa fa-check"></i><b>3.2</b> Access, Download, and Unzip</a></li>
<li class="chapter" data-level="3.3" data-path="chapter-polygon-data.html"><a href="chapter-polygon-data.html#data-preparation-with-sf"><i class="fa fa-check"></i><b>3.3</b> Data Preparation with <code>sf</code></a></li>
<li class="chapter" data-level="3.4" data-path="chapter-polygon-data.html"><a href="chapter-polygon-data.html#exploratory-analysis-with-sf"><i class="fa fa-check"></i><b>3.4</b> Exploratory Analysis with <code>sf</code></a></li>
<li class="chapter" data-level="3.5" data-path="chapter-polygon-data.html"><a href="chapter-polygon-data.html#data-preparation-with-terra"><i class="fa fa-check"></i><b>3.5</b> Data Preparation with <code>terra</code></a></li>
<li class="chapter" data-level="3.6" data-path="chapter-polygon-data.html"><a href="chapter-polygon-data.html#exploratory-analysis-with-terra"><i class="fa fa-check"></i><b>3.6</b> Exploratory Analysis with <code>terra</code></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter-raster-data.html"><a href="chapter-raster-data.html"><i class="fa fa-check"></i><b>4</b> Raster Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter-raster-data.html"><a href="chapter-raster-data.html#introduction-4"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="chapter-raster-data.html"><a href="chapter-raster-data.html#raster-access"><i class="fa fa-check"></i><b>4.2</b> Access and Download</a></li>
<li class="chapter" data-level="4.3" data-path="chapter-raster-data.html"><a href="chapter-raster-data.html#data-preparation-1"><i class="fa fa-check"></i><b>4.3</b> Data Preparation</a></li>
<li class="chapter" data-level="4.4" data-path="chapter-raster-data.html"><a href="chapter-raster-data.html#exploratory-analysis-1"><i class="fa fa-check"></i><b>4.4</b> Exploratory Analysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="wildfire-data.html"><a href="wildfire-data.html"><i class="fa fa-check"></i><strong>Wildfire Data</strong></a></li>
<li class="chapter" data-level="" data-path="other-environmental-data.html"><a href="other-environmental-data.html"><i class="fa fa-check"></i><strong>Other Environmental Data</strong></a></li>
<li class="chapter" data-level="5" data-path="chapter-nasa-earthdata.html"><a href="chapter-nasa-earthdata.html"><i class="fa fa-check"></i><b>5</b> NASA EarthData Download</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter-nasa-earthdata.html"><a href="chapter-nasa-earthdata.html#introduction-5"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="chapter-nasa-earthdata.html"><a href="chapter-nasa-earthdata.html#nasa-earthdata-account"><i class="fa fa-check"></i><b>5.2</b> NASA EarthData Account</a></li>
<li class="chapter" data-level="5.3" data-path="chapter-nasa-earthdata.html"><a href="chapter-nasa-earthdata.html#generate-prerequisite-files"><i class="fa fa-check"></i><b>5.3</b> Generate Prerequisite Files</a></li>
<li class="chapter" data-level="5.4" data-path="chapter-nasa-earthdata.html"><a href="chapter-nasa-earthdata.html#download-data"><i class="fa fa-check"></i><b>5.4</b> Download Data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="health-data-integration.html"><a href="health-data-integration.html"><i class="fa fa-check"></i><strong>Health Data Integration</strong></a></li>
<li class="chapter" data-level="6" data-path="chapter-link-to-census.html"><a href="chapter-link-to-census.html"><i class="fa fa-check"></i><b>6</b> Linkage to Census Units</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter-link-to-census.html"><a href="chapter-link-to-census.html#introduction-6"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="chapter-link-to-census.html"><a href="chapter-link-to-census.html#tutorial"><i class="fa fa-check"></i><b>6.2</b> Tutorial</a></li>
<li class="chapter" data-level="6.3" data-path="chapter-link-to-census.html"><a href="chapter-link-to-census.html#concluding-remarks"><i class="fa fa-check"></i><b>6.3</b> Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter-fhir-pit.html"><a href="chapter-fhir-pit.html"><i class="fa fa-check"></i><b>7</b> A FHIR PIT Tutorial</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chapter-fhir-pit.html"><a href="chapter-fhir-pit.html#introduction-7"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="chapter-fhir-pit.html"><a href="chapter-fhir-pit.html#tutorial-1"><i class="fa fa-check"></i><b>7.2</b> Tutorial</a></li>
<li class="chapter" data-level="7.3" data-path="chapter-fhir-pit.html"><a href="chapter-fhir-pit.html#fhir-pit-considerations"><i class="fa fa-check"></i><b>7.3</b> Considerations</a></li>
<li class="chapter" data-level="7.4" data-path="chapter-fhir-pit.html"><a href="chapter-fhir-pit.html#concluding-remarks-1"><i class="fa fa-check"></i><b>7.4</b> Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="case-studies.html"><a href="case-studies.html"><i class="fa fa-check"></i><strong>Case Studies</strong></a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><strong>Appendix</strong></a></li>
<li class="chapter" data-level="" data-path="chapter-user-profiles.html"><a href="chapter-user-profiles.html"><i class="fa fa-check"></i><strong>A</strong> User Profiles</a></li>
<li class="chapter" data-level="" data-path="chords-glossary.html"><a href="chords-glossary.html"><i class="fa fa-check"></i><strong>B</strong> CHORDS Glossary</a></li>
<li class="chapter" data-level="" data-path="all-references-appendix.html"><a href="all-references-appendix.html"><i class="fa fa-check"></i><strong>C</strong> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" 
target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The CHORDS Toolkit for Health and Geospatial Exposures Research</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter-point-data" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> Point Data<a href="chapter-point-data.html#chapter-point-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><a href="chapter-user-profiles.html#profilecmp"><img src="images/user_profiles/profilecmp.svg" alt="Profile-CMP" /></a>
<a href="chapter-user-profiles.html#profilesbs"><img src="images/user_profiles/profilesbs.svg" alt="Profile-SBS" /></a>
<a href="chapter-user-profiles.html#profilestu"><img src="images/user_profiles/profilestu.svg" alt="Profile-STU" /></a></p>
<div id="point-data-access-preparation-and-exploratory-analysis-in-r" class="section level3 unnumbered hasAnchor">
<h3>Point Data Access, Preparation, and Exploratory Analysis in R<a href="chapter-point-data.html#point-data-access-preparation-and-exploratory-analysis-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Date Modified:</strong> May 6, 2024</p>
<p><strong>Authors:</strong> Mitchell Manware <a href="https://orcid.org/0009-0003-6440-6106"><img src="images/orcid.png" width="10" alt="author-mm" /></a>, Kyle P. Messier <a href="https://orcid.org/0000-0001-9508-9623"><img src="images/orcid.png" width="10" alt="author-kpm" /></a></p>
<p><strong>Key Terms:</strong> <a href="https://tools.niehs.nih.gov/cchhglossary/?keyword=air+pollution&amp;termOnlySearch=true&amp;exactSearch=true">Air Pollution</a>, <a href="chords-glossary.html#def-geospatial-data">Geospatial Data</a>, <a href="https://tools.niehs.nih.gov/cchhglossary/?keyword=particulate+matter&amp;termOnlySearch=true&amp;exactSearch=true">Particulate Matter</a></p>
<p><strong>Programming Language:</strong> R</p>
</div>
<div id="introduction-2" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Introduction<a href="chapter-point-data.html#introduction-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Air pollution monitoring data from the United States Environmental Protection Agency (EPA) will be used to demonstrate using point data with the <code>sf</code> package <span class="citation">(<a href="#ref-r-sf-1">1</a>)</span>.</p>
<p>This tutorial will demonstrate the following steps with point data in <code>R</code>:</p>
<ul>
<li>Downloading data from a URL</li>
<li>Importing data</li>
<li>Checking data type, structure, and class</li>
<li>Reclassifying data</li>
<li>Computing summary and zonal statistics</li>
<li>Plotting individual and multiple data sets</li>
</ul>
<div class="important">
<p>The exploratory analyses in this unit are designed for educational purposes only. The results of the following analyses are not peer-reviewed findings, nor are they based on any hypotheses.</p>
</div>
</div>
<div id="access-download-and-unzip" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Access, Download, and Unzip<a href="chapter-point-data.html#access-download-and-unzip" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To download data with the <code>utils::download.file()</code> function, define two variables. One variable to store the website URL where the data exists and a second to store the file path for where the file should be saved.</p>
<div class="note">
<p>Multiple chunks of code in this tutorial will contain <code>/   YOUR FILE PATH   /</code>. To run the code on your machine, substitute <code>/   YOUR FILE PATH   /</code> with the file path where you would like to store the tutorial data.</p>
</div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="chapter-point-data.html#cb2-1" tabindex="-1"></a>url_epa <span class="ot">&lt;-</span> <span class="st">&quot;https://aqs.epa.gov/aqsweb/airdata/daily_88101_2021.zip&quot;</span></span>
<span id="cb2-2"><a href="chapter-point-data.html#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="chapter-point-data.html#cb2-3" tabindex="-1"></a>destination_epa <span class="ot">&lt;-</span> <span class="st">&quot;/   YOUR FILE PATH   /epa_data.zip&quot;</span></span>
<span id="cb2-4"><a href="chapter-point-data.html#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="chapter-point-data.html#cb2-5" tabindex="-1"></a><span class="fu">download.file</span>(</span>
<span id="cb2-6"><a href="chapter-point-data.html#cb2-6" tabindex="-1"></a>  url_epa,</span>
<span id="cb2-7"><a href="chapter-point-data.html#cb2-7" tabindex="-1"></a>  destination_epa</span>
<span id="cb2-8"><a href="chapter-point-data.html#cb2-8" tabindex="-1"></a>)</span></code></pre></div>
<p>The file downloaded from the EPA website is a zip file. Zip files need to be unzipped (decompressed) in order to access the data within. Unzip the EPA air pollution file with <code>utils::unzip()</code>.</p>
<div class="warning">
<p>Unzipping a <code>.zip</code> file will decompress the contents within. Spatial data sets can be very large (i.e., &gt; 1 GB ), so check the size of the data before unzipping on your machine.</p>
</div>
<p>The numeric value size of the file is listed under <code>Length</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="chapter-point-data.html#cb3-1" tabindex="-1"></a><span class="fu">unzip</span>(<span class="st">&quot;/   YOUR FILE PATH   /epa_data.zip&quot;</span>,</span>
<span id="cb3-2"><a href="chapter-point-data.html#cb3-2" tabindex="-1"></a>  <span class="at">list =</span> <span class="cn">TRUE</span></span>
<span id="cb3-3"><a href="chapter-point-data.html#cb3-3" tabindex="-1"></a>)</span></code></pre></div>
<p>After inspecting the file size, unzip <code>epa_data.zip</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="chapter-point-data.html#cb4-1" tabindex="-1"></a><span class="fu">unzip</span>(<span class="st">&quot;/   YOUR FILE PATH   /epa_data.zip&quot;</span>)</span></code></pre></div>
<p>Inspecting the file with <code>utils::unzip(list = TRUE)</code> returned the size of the file, but also the name of the data file of interest. The desired data file can also be identified with <code>list.files()</code>.</p>
<div class="note">
<p>Other file names may be returned if <code>/   YOUR FILE PATH   /</code> is a directory with other contents (e.g., Desktop or Documents folder).</p>
</div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="chapter-point-data.html#cb5-1" tabindex="-1"></a><span class="fu">list.files</span>(<span class="st">&quot;/   YOUR FILE PATH   /&quot;</span>)</span></code></pre></div>
</div>
<div id="data-preparation" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Data Preparation<a href="chapter-point-data.html#data-preparation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="import" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Import<a href="chapter-point-data.html#import" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that the contents of the zip file have been saved on your machine and the data file of interest has been identified, import the data with <code>sf::st_read()</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="chapter-point-data.html#cb6-1" tabindex="-1"></a>pm <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;/   YOUR FILE PATH   /daily_88101_2021.csv&quot;</span>)</span></code></pre></div>
<p>The previous chunk of code returned a <code>Warning:</code> message. This warning informs the user that the imported data does not have native spatial features, so the data was imported as a <code>data.frame</code>.</p>
</div>
<div id="inspect-structure" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Inspect Structure<a href="chapter-point-data.html#inspect-structure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Inspect the structure of <code>pm</code> to see its class, column names, column classes, and the first two (specified by <code>vec.len = 2</code>) data points from each column.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="chapter-point-data.html#cb7-1" tabindex="-1"></a><span class="fu">str</span>(pm,</span>
<span id="cb7-2"><a href="chapter-point-data.html#cb7-2" tabindex="-1"></a>  <span class="at">vec.len =</span> <span class="dv">2</span></span>
<span id="cb7-3"><a href="chapter-point-data.html#cb7-3" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="subset" class="section level3 hasAnchor" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> Subset<a href="chapter-point-data.html#subset" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Checking the data structure shows that <code>pm</code> is a very large data set. Each of the variables convey important information related to air pollution monitoring, but not all will be utilized in these exploratory analyses.</p>
<p>The data set can be reduced to include only the variables of interest with the <code>subset()</code> function. The <code>select =</code> argument indicates which variables to be retained in the new data set.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="chapter-point-data.html#cb8-1" tabindex="-1"></a>pm <span class="ot">&lt;-</span> <span class="fu">subset</span>(pm, <span class="at">select =</span> <span class="fu">c</span>(</span>
<span id="cb8-2"><a href="chapter-point-data.html#cb8-2" tabindex="-1"></a>  State.Code,</span>
<span id="cb8-3"><a href="chapter-point-data.html#cb8-3" tabindex="-1"></a>  County.Code,</span>
<span id="cb8-4"><a href="chapter-point-data.html#cb8-4" tabindex="-1"></a>  Site.Num,</span>
<span id="cb8-5"><a href="chapter-point-data.html#cb8-5" tabindex="-1"></a>  Latitude,</span>
<span id="cb8-6"><a href="chapter-point-data.html#cb8-6" tabindex="-1"></a>  Longitude,</span>
<span id="cb8-7"><a href="chapter-point-data.html#cb8-7" tabindex="-1"></a>  State.Name,</span>
<span id="cb8-8"><a href="chapter-point-data.html#cb8-8" tabindex="-1"></a>  Date.Local,</span>
<span id="cb8-9"><a href="chapter-point-data.html#cb8-9" tabindex="-1"></a>  Arithmetic.Mean</span>
<span id="cb8-10"><a href="chapter-point-data.html#cb8-10" tabindex="-1"></a>))</span></code></pre></div>
<p>Re-running <code>str(pm)</code> after subsetting the data set shows that all observations (n = 590,208) of the variables of interest (n = 8) have been retained.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="chapter-point-data.html#cb9-1" tabindex="-1"></a><span class="fu">str</span>(pm,</span>
<span id="cb9-2"><a href="chapter-point-data.html#cb9-2" tabindex="-1"></a>  <span class="at">vec.len =</span> <span class="dv">2</span></span>
<span id="cb9-3"><a href="chapter-point-data.html#cb9-3" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="reclassify" class="section level3 hasAnchor" number="2.3.4">
<h3><span class="header-section-number">2.3.4</span> Reclassify<a href="chapter-point-data.html#reclassify" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>str()</code> function showed the class of each variable within the data set. All of the retained variables are of class character, indicated by <code>: chr</code> and the quotations around each observation (<code>"01" "01" ...</code>).</p>
<p>The class of a variable depends on the information conveyed by the data stored within that variable. For example, character is an appropriate class for the <code>pm$State.Name</code> variable because each observation is a character string labeling in which state the monitor was located. Alternatively, character is not appropriate for the <code>pm$Arithmetic.Mean</code> or <code>pm$Date.Local</code> variables because each observation is a numeric decimal or time-referenced date, respectively.</p>
<p>The <code>as.</code> functions can be used for reclassifying data. Reclassify <code>pm$Arithmetic.Mean</code> as a number, and <code>pm$Date.Local</code> as a date.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="chapter-point-data.html#cb10-1" tabindex="-1"></a>pm<span class="sc">$</span>Arithmetic.Mean <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(pm<span class="sc">$</span>Arithmetic.Mean)</span>
<span id="cb10-2"><a href="chapter-point-data.html#cb10-2" tabindex="-1"></a>pm<span class="sc">$</span>Date.Local <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(pm<span class="sc">$</span>Date.Local)</span></code></pre></div>
<p>After running the <code>as.</code> functions, ensure that the two variables have been reclassified to the desired classes.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="chapter-point-data.html#cb11-1" tabindex="-1"></a><span class="fu">class</span>(pm<span class="sc">$</span>Arithmetic.Mean)</span>
<span id="cb11-2"><a href="chapter-point-data.html#cb11-2" tabindex="-1"></a><span class="fu">class</span>(pm<span class="sc">$</span>Date.Local)</span></code></pre></div>
</div>
<div id="convert-to-sf-object" class="section level3 hasAnchor" number="2.3.5">
<h3><span class="header-section-number">2.3.5</span> Convert to <code>sf</code> Object<a href="chapter-point-data.html#convert-to-sf-object" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With the variables of interest selected and reclassified, <code>pm</code> can be converted to spatially defined <code>sf</code> object. The <code>sf::st_as_sf()</code> function creates a <code>$geometry</code> field based on the latitude and longitude coordinates contained within <code>pm</code>. The <code>coords = c()</code> argument specifies the column names which contain the coordinate values.</p>
<div class="note">
<p>The columns containing coordinate values will not always be “Latitude” and “Longitude”. Use <code>str()</code> to see column names and identify which contain the coordinate values.</p>
</div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="chapter-point-data.html#cb12-1" tabindex="-1"></a>pm_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(pm,</span>
<span id="cb12-2"><a href="chapter-point-data.html#cb12-2" tabindex="-1"></a>  <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>, <span class="st">&quot;Latitude&quot;</span>)</span>
<span id="cb12-3"><a href="chapter-point-data.html#cb12-3" tabindex="-1"></a>)</span></code></pre></div>
<p>Inspect the classes of <code>pm_sf</code> and <code>pm_sf$geometry</code> to see their differences, and how each are different than <code>class(pm)</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="chapter-point-data.html#cb13-1" tabindex="-1"></a><span class="fu">class</span>(pm_sf)</span>
<span id="cb13-2"><a href="chapter-point-data.html#cb13-2" tabindex="-1"></a><span class="fu">class</span>(pm_sf<span class="sc">$</span>geometry)</span></code></pre></div>
<p><code>class(pm_sf)</code> returned both <code>"sf"</code> and <code>"data.frame"</code>, indicating that it contains both spatial and non-spatial data.</p>
</div>
<div id="coordinate-reference-system-and-projection" class="section level3 hasAnchor" number="2.3.6">
<h3><span class="header-section-number">2.3.6</span> Coordinate Reference System and Projection<a href="chapter-point-data.html#coordinate-reference-system-and-projection" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The coordinate reference system of an <code>sf</code> object can be checked with <code>sf::st_crs()</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="chapter-point-data.html#cb14-1" tabindex="-1"></a><span class="fu">st_crs</span>(pm_sf)</span></code></pre></div>
<p>The previous chunk of code shows that <code>pm_sf</code> does not have a native coordinate reference system. The same function, <code>sf::st_crs()</code>, can be used to assign a coordinate reference system to an <code>sf</code> object. For this example, the World Geodetic System 1984 (WGS 84) will be used (EPSG code: 4326).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="chapter-point-data.html#cb15-1" tabindex="-1"></a><span class="fu">st_crs</span>(pm_sf) <span class="ot">&lt;-</span> <span class="dv">4326</span></span>
<span id="cb15-2"><a href="chapter-point-data.html#cb15-2" tabindex="-1"></a><span class="fu">st_crs</span>(pm_sf)</span></code></pre></div>
<p>An <code>sf</code> object with a coordinate reference system can be transformed (projected) into a different coordinate reference system with <code>sf::st_transform()</code>. The area of interest for these exploratory analyses is the conterminous United States, so the Albers Equal Area projected coordinate system will be used (EPSG code: 5070). For a detailed description of coordinate reference systems, and how to select the best system for your analyses, see Section <a href="chapter-getting-started-spatial.html#getting-started-spatial-crs">Coordinate Reference Systems and Projections</a> in the Chapter <a href="chapter-getting-started-spatial.html#chapter-getting-started-spatial">Getting Started</a>.</p>
<div class="note">
<p>An <code>sf</code> object without an assigned coordinate reference system cannot be transformed. <code>sf::st_crs()</code> must be used to assign a coordinate reference system to an <code>sf</code> object that does not have one.</p>
</div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="chapter-point-data.html#cb16-1" tabindex="-1"></a>pm_sf <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(</span>
<span id="cb16-2"><a href="chapter-point-data.html#cb16-2" tabindex="-1"></a>  pm_sf,</span>
<span id="cb16-3"><a href="chapter-point-data.html#cb16-3" tabindex="-1"></a>  <span class="dv">5070</span></span>
<span id="cb16-4"><a href="chapter-point-data.html#cb16-4" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="exploratory-analysis" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Exploratory Analysis<a href="chapter-point-data.html#exploratory-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="plot" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Plot<a href="chapter-point-data.html#plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Plotting spatial data is important for visualizing and analyzing patterns in the data. Initialize a plot for the locations of each air pollution monitoring station with <code>ggplot2::ggplot()</code>. Identifying the data set to be plotted within the <code>geom_sf()</code> argument informs the function that the data is an <code>sf</code> object.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="chapter-point-data.html#cb17-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb17-2"><a href="chapter-point-data.html#cb17-2" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> pm_sf) <span class="sc">+</span></span>
<span id="cb17-3"><a href="chapter-point-data.html#cb17-3" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Air Pollution Monitor Locations&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-4"><a href="chapter-point-data.html#cb17-4" tabindex="-1"></a>  <span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb17-5"><a href="chapter-point-data.html#cb17-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb17-6"><a href="chapter-point-data.html#cb17-6" tabindex="-1"></a>  <span class="fu">grids</span>()</span></code></pre></div>
<p><img src="images/intro_to_spatial/epa_monitors.png" width = "75%" height = "auto" class = "centerimage"></p>
<p>The plot shows the distribution of monitoring locations, and roughly depicts the outline of the United States due to the large number of monitors. The plot does not, however, convey any information about the concentration of PM<sub>2.5</sub> measured by each monitor. Inspect the summary statistics of the PM<sub>2.5</sub> measurements before creating any plots to visualize the data.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="chapter-point-data.html#cb18-1" tabindex="-1"></a><span class="fu">summary</span>(pm_sf<span class="sc">$</span>Arithmetic.Mean)</span>
<span id="cb18-2"><a href="chapter-point-data.html#cb18-2" tabindex="-1"></a><span class="fu">sd</span>(pm_sf<span class="sc">$</span>Arithmetic.Mean)</span></code></pre></div>
<p>After inspecting the summary statistics, create a histogram of the PM<sub>2.5</sub> concentration measurements to visualize the distribution of the data.</p>
<div class="note">
<p>The histogram is not a spatially defined plot, so the data set to be plotted is identified within <code>ggplot()</code>.</p>
</div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="chapter-point-data.html#cb19-1" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb19-2"><a href="chapter-point-data.html#cb19-2" tabindex="-1"></a>  <span class="at">data =</span> pm_sf,</span>
<span id="cb19-3"><a href="chapter-point-data.html#cb19-3" tabindex="-1"></a>  <span class="fu">aes</span>(Arithmetic.Mean)</span>
<span id="cb19-4"><a href="chapter-point-data.html#cb19-4" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb19-5"><a href="chapter-point-data.html#cb19-5" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb19-6"><a href="chapter-point-data.html#cb19-6" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb19-7"><a href="chapter-point-data.html#cb19-7" tabindex="-1"></a>    <span class="at">binwidth =</span> <span class="dv">5</span></span>
<span id="cb19-8"><a href="chapter-point-data.html#cb19-8" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-9"><a href="chapter-point-data.html#cb19-9" tabindex="-1"></a>  <span class="fu">ggtitle</span>(</span>
<span id="cb19-10"><a href="chapter-point-data.html#cb19-10" tabindex="-1"></a>    <span class="fu">expression</span>(<span class="st">&quot;PM&quot;</span>[<span class="fl">2.5</span>] <span class="sc">*</span> <span class="st">&quot; Concentration Measurements&quot;</span>)</span>
<span id="cb19-11"><a href="chapter-point-data.html#cb19-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-12"><a href="chapter-point-data.html#cb19-12" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="st">&quot;PM&quot;</span>[<span class="fl">2.5</span>] <span class="sc">*</span> <span class="st">&quot; Concentration (µg/m&quot;</span><span class="sc">^</span><span class="dv">3</span> <span class="sc">*</span> <span class="st">&quot;)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb19-13"><a href="chapter-point-data.html#cb19-13" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of Measurements&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-14"><a href="chapter-point-data.html#cb19-14" tabindex="-1"></a>  <span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb19-15"><a href="chapter-point-data.html#cb19-15" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb19-16"><a href="chapter-point-data.html#cb19-16" tabindex="-1"></a>  <span class="fu">grids</span>()</span></code></pre></div>
<p><img src="images/intro_to_spatial/pm_concentrations_histogram.png" width = "75%" height = "auto" class = "centerimage"></p>
</div>
<div id="calculate-annual-mean" class="section level3 hasAnchor" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Calculate Annual Mean<a href="chapter-point-data.html#calculate-annual-mean" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A common summary statistic of interest to researchers is the mean over a certain period of time. For this example, we will calculate the mean PM<sub>2.5</sub> concentration for each monitoring location for the year 2021. To do this, a unique identification code must be created for each monitoring location.</p>
<p>The <code>pm_sf$Monitor.ID</code> variable can be created by concatenating each monitor’s state code, county code, and site number together into a single character string.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="chapter-point-data.html#cb20-1" tabindex="-1"></a>pm_sf<span class="sc">$</span>Monitor.ID <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb20-2"><a href="chapter-point-data.html#cb20-2" tabindex="-1"></a>  pm_sf<span class="sc">$</span>State.Code,</span>
<span id="cb20-3"><a href="chapter-point-data.html#cb20-3" tabindex="-1"></a>  pm_sf<span class="sc">$</span>County.Code,</span>
<span id="cb20-4"><a href="chapter-point-data.html#cb20-4" tabindex="-1"></a>  pm_sf<span class="sc">$</span>Site.Num</span>
<span id="cb20-5"><a href="chapter-point-data.html#cb20-5" tabindex="-1"></a>)</span></code></pre></div>
<p>Each unique monitor identification code should be matched with a unique monitor location geometry. To ensure that each monitor location has a unique identification code, check that there are an equal number of unique geometries and identification codes.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="chapter-point-data.html#cb21-1" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(pm_sf<span class="sc">$</span>Monitor.ID)) <span class="sc">==</span> <span class="fu">length</span>(<span class="fu">unique</span>(pm_sf<span class="sc">$</span>geometry))</span></code></pre></div>
<p>Now that each monitor location has a unique identification code, we can calculate the mean PM<sub>2.5</sub> concentration measured at each monitoring location. Functions and syntax from the <code>dplyr</code> package will be used to do this. For more on the <code>dplyr</code> package, please see <a href="https://dplyr.tidyverse.org/articles/dplyr.html">Introduction to dplyr</a>.</p>
<p>The <code>group_by(Monitor.ID, )</code> argument specifies that an annual mean should be calculated for each unique <code>Monitor.ID</code>. Including <code>State.Name</code> in this argument retains the column in the new <code>pm_mean</code> data set, but does not influence the calculation of the annual mean.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="chapter-point-data.html#cb22-1" tabindex="-1"></a>pm_mean <span class="ot">&lt;-</span></span>
<span id="cb22-2"><a href="chapter-point-data.html#cb22-2" tabindex="-1"></a>  pm_sf <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="chapter-point-data.html#cb22-3" tabindex="-1"></a>  <span class="fu">group_by</span>(Monitor.ID, State.Name) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="chapter-point-data.html#cb22-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Annual.Mean =</span> <span class="fu">mean</span>(Arithmetic.Mean))</span></code></pre></div>
<p>Inspect the summary statistics of <code>pm_mean</code>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="chapter-point-data.html#cb23-1" tabindex="-1"></a><span class="fu">summary</span>(pm_mean<span class="sc">$</span>Annual.Mean)</span>
<span id="cb23-2"><a href="chapter-point-data.html#cb23-2" tabindex="-1"></a><span class="fu">sd</span>(pm_mean<span class="sc">$</span>Annual.Mean)</span></code></pre></div>
<p>Create a plot which shows the distribution of monitoring locations, and color each point according to the monitor’s annual mean concentration of PM<sub>2.5</sub>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="chapter-point-data.html#cb24-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb24-2"><a href="chapter-point-data.html#cb24-2" tabindex="-1"></a>  <span class="fu">geom_sf</span>(</span>
<span id="cb24-3"><a href="chapter-point-data.html#cb24-3" tabindex="-1"></a>    <span class="at">data =</span> pm_mean,</span>
<span id="cb24-4"><a href="chapter-point-data.html#cb24-4" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color =</span> Annual.Mean)</span>
<span id="cb24-5"><a href="chapter-point-data.html#cb24-5" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-6"><a href="chapter-point-data.html#cb24-6" tabindex="-1"></a>  <span class="fu">scale_color_viridis_b</span>(</span>
<span id="cb24-7"><a href="chapter-point-data.html#cb24-7" tabindex="-1"></a>    <span class="fu">expression</span>(<span class="st">&quot;PM&quot;</span>[<span class="fl">2.5</span>] <span class="sc">*</span> <span class="st">&quot; Concentration (µg/m&quot;</span><span class="sc">^</span><span class="dv">3</span> <span class="sc">*</span> <span class="st">&quot;)&quot;</span>)</span>
<span id="cb24-8"><a href="chapter-point-data.html#cb24-8" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-9"><a href="chapter-point-data.html#cb24-9" tabindex="-1"></a>  <span class="fu">ggtitle</span>(</span>
<span id="cb24-10"><a href="chapter-point-data.html#cb24-10" tabindex="-1"></a>    <span class="fu">expression</span>(<span class="st">&quot;Annual Mean PM&quot;</span>[<span class="fl">2.5</span>] <span class="sc">*</span> <span class="st">&quot; Concentration&quot;</span>)</span>
<span id="cb24-11"><a href="chapter-point-data.html#cb24-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-12"><a href="chapter-point-data.html#cb24-12" tabindex="-1"></a>  <span class="fu">theme_pubr</span>(<span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-13"><a href="chapter-point-data.html#cb24-13" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb24-14"><a href="chapter-point-data.html#cb24-14" tabindex="-1"></a>  <span class="fu">grids</span>()</span></code></pre></div>
<p><img src="images/intro_to_spatial/epa_monitors_concentrations.png" width = "75%" height = "auto" class = "centerimage"></p>
<p>Now the plot depicts both spatial and non-spatial data.</p>
</div>
<div id="compare-highest-annual-means" class="section level3 hasAnchor" number="2.4.3">
<h3><span class="header-section-number">2.4.3</span> Compare Highest Annual Means<a href="chapter-point-data.html#compare-highest-annual-means" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A close visual inspection of the previous plot shows a few monitoring locations in the southwestern region of the United States with very high (&gt; 20 µm/m<sup>3</sup>) annual mean concentrations of PM<sub>2.5</sub>. To investigate the differences between the monitors with the highest and lowest annual mean concentrations, create a subset of <code>pm_sf</code> with only the three highest and lowest monitors.</p>
<p>To do this, first identify the monitors with the highest and lowest annual mean concentrations.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="chapter-point-data.html#cb25-1" tabindex="-1"></a>min_monitors <span class="ot">&lt;-</span></span>
<span id="cb25-2"><a href="chapter-point-data.html#cb25-2" tabindex="-1"></a>  pm_mean <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="chapter-point-data.html#cb25-3" tabindex="-1"></a>  <span class="fu">arrange</span>(Annual.Mean) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="chapter-point-data.html#cb25-4" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb25-5"><a href="chapter-point-data.html#cb25-5" tabindex="-1"></a></span>
<span id="cb25-6"><a href="chapter-point-data.html#cb25-6" tabindex="-1"></a>max_monitors <span class="ot">&lt;-</span></span>
<span id="cb25-7"><a href="chapter-point-data.html#cb25-7" tabindex="-1"></a>  pm_mean <span class="sc">%&gt;%</span></span>
<span id="cb25-8"><a href="chapter-point-data.html#cb25-8" tabindex="-1"></a>  <span class="fu">arrange</span>(Annual.Mean) <span class="sc">%&gt;%</span></span>
<span id="cb25-9"><a href="chapter-point-data.html#cb25-9" tabindex="-1"></a>  <span class="fu">tail</span>(<span class="at">n =</span> <span class="dv">3</span>)</span></code></pre></div>
<p>Next, create a variable storing only the unique identification codes of these six monitors.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="chapter-point-data.html#cb26-1" tabindex="-1"></a>min_max_monitors_id <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb26-2"><a href="chapter-point-data.html#cb26-2" tabindex="-1"></a>  min_monitors<span class="sc">$</span>Monitor.ID,</span>
<span id="cb26-3"><a href="chapter-point-data.html#cb26-3" tabindex="-1"></a>  max_monitors<span class="sc">$</span>Monitor.ID</span>
<span id="cb26-4"><a href="chapter-point-data.html#cb26-4" tabindex="-1"></a>)</span></code></pre></div>
<p>Finally, subset the <code>pm_sf</code> data set according to the monitor identification codes stored in <code>min_max_monitors_id</code>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="chapter-point-data.html#cb27-1" tabindex="-1"></a>pm_min_max <span class="ot">&lt;-</span> <span class="fu">subset</span>(pm_sf,</span>
<span id="cb27-2"><a href="chapter-point-data.html#cb27-2" tabindex="-1"></a>  <span class="at">subset =</span> Monitor.ID <span class="sc">==</span> min_max_monitors_id</span>
<span id="cb27-3"><a href="chapter-point-data.html#cb27-3" tabindex="-1"></a>)</span></code></pre></div>
<p>The resulting <code>pm_min_max</code> data set contains data for only six monitoring locations. Check the unique monitor identification codes that constitute the new data set.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="chapter-point-data.html#cb28-1" tabindex="-1"></a><span class="fu">unique</span>(pm_min_max<span class="sc">$</span>Monitor.ID)</span></code></pre></div>
<p>The temporal trend of PM<sub>2.5</sub> concentrations measured at each of these locations in 2021 can be depicted with <code>ggplot::geom_line()</code>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="chapter-point-data.html#cb29-1" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb29-2"><a href="chapter-point-data.html#cb29-2" tabindex="-1"></a>  <span class="at">data =</span> pm_min_max,</span>
<span id="cb29-3"><a href="chapter-point-data.html#cb29-3" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb29-4"><a href="chapter-point-data.html#cb29-4" tabindex="-1"></a>    <span class="at">x =</span> Date.Local,</span>
<span id="cb29-5"><a href="chapter-point-data.html#cb29-5" tabindex="-1"></a>    <span class="at">y =</span> Arithmetic.Mean,</span>
<span id="cb29-6"><a href="chapter-point-data.html#cb29-6" tabindex="-1"></a>    <span class="at">group =</span> Monitor.ID,</span>
<span id="cb29-7"><a href="chapter-point-data.html#cb29-7" tabindex="-1"></a>    <span class="at">color =</span> Monitor.ID</span>
<span id="cb29-8"><a href="chapter-point-data.html#cb29-8" tabindex="-1"></a>  )</span>
<span id="cb29-9"><a href="chapter-point-data.html#cb29-9" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb29-10"><a href="chapter-point-data.html#cb29-10" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb29-11"><a href="chapter-point-data.html#cb29-11" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Minimum and Maximum Monitors&quot;</span>) <span class="sc">+</span></span>
<span id="cb29-12"><a href="chapter-point-data.html#cb29-12" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Date&quot;</span>) <span class="sc">+</span></span>
<span id="cb29-13"><a href="chapter-point-data.html#cb29-13" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="st">&quot;PM&quot;</span>[<span class="fl">2.5</span>] <span class="sc">*</span> <span class="st">&quot; Concentrations (µg/m&quot;</span><span class="sc">^</span><span class="dv">3</span> <span class="sc">*</span> <span class="st">&quot;)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb29-14"><a href="chapter-point-data.html#cb29-14" tabindex="-1"></a>  <span class="fu">theme_pubr</span>(<span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb29-15"><a href="chapter-point-data.html#cb29-15" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="images/intro_to_spatial/min_max_monitors.png" width = "75%" height = "auto" class = "centerimage"></p>
<p>Alternatively, the <code>ggplot2::geom_boxplot()</code> function compares the median, interquartile range, and outliers of the monitors’ measurements.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="chapter-point-data.html#cb30-1" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb30-2"><a href="chapter-point-data.html#cb30-2" tabindex="-1"></a>  <span class="at">data =</span> pm_min_max,</span>
<span id="cb30-3"><a href="chapter-point-data.html#cb30-3" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb30-4"><a href="chapter-point-data.html#cb30-4" tabindex="-1"></a>    <span class="at">x =</span> Monitor.ID,</span>
<span id="cb30-5"><a href="chapter-point-data.html#cb30-5" tabindex="-1"></a>    <span class="at">y =</span> Arithmetic.Mean,</span>
<span id="cb30-6"><a href="chapter-point-data.html#cb30-6" tabindex="-1"></a>    <span class="at">fill =</span> Monitor.ID</span>
<span id="cb30-7"><a href="chapter-point-data.html#cb30-7" tabindex="-1"></a>  )</span>
<span id="cb30-8"><a href="chapter-point-data.html#cb30-8" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb30-9"><a href="chapter-point-data.html#cb30-9" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb30-10"><a href="chapter-point-data.html#cb30-10" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Monitor ID&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-11"><a href="chapter-point-data.html#cb30-11" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="st">&quot;PM&quot;</span>[<span class="fl">2.5</span>] <span class="sc">*</span> <span class="st">&quot; Concentrations (µg/m&quot;</span><span class="sc">^</span><span class="dv">3</span> <span class="sc">*</span> <span class="st">&quot;)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb30-12"><a href="chapter-point-data.html#cb30-12" tabindex="-1"></a>  <span class="fu">theme_pubr</span>(<span class="at">legend =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="images/intro_to_spatial/monitors_boxplot.png" width = "75%" height = "auto" class = "centerimage"></p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body">
<div id="ref-r-sf-1" class="csl-entry">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Pebesma, Edzer. 2018. <span>“<span class="nocase">Simple Features for <span>R</span>: Standardized Support for Spatial Vector Data</span>.”</span> <em><span>The R Journal</span></em> 10 (1): 439–46. <a href="https://doi.org/10.32614/RJ-2018-009">https://doi.org/10.32614/RJ-2018-009</a></div>
</div>
</div>
<!DOCTYPE html>
<script src="https://cdn.jsdelivr.net/npm/@xiee/utils/js/external-link.min.js" defer></script>
            </section>

          </div>
        </div>
      </div>
<a href="chapter-getting-started-spatial.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter-polygon-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
